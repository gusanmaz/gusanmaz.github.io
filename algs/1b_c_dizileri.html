<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1.2: C Dizileri ve Analiz</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <style>
        .tape-container { 
            display: flex; justify-content: center; gap: 5px; margin: 30px 0; min-height: 80px; 
            position: relative; /* Animasyon iÃ§in */
        }
        .tape-cell {
            width: 60px; height: 60px; border: 2px solid #333; background: white;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; font-size: 1.2em; position: relative; 
            transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1), background 0.3s, opacity 0.3s;
        }
        .idx { position: absolute; top: -20px; font-size: 12px; color: #666; }
        
        /* Animation States */
        .moving-right { transform: translateX(65px); background: #f1c40f; } /* 60px width + 5px gap */
        .moving-left { transform: translateX(-65px); background: #e67e22; }
        .new-item { background: #27ae60; color: white; animation: popIn 0.5s; }
        .deleted { background: #c0392b; color: white; opacity: 0; transform: scale(0.5); }
        
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ•°ï¸ 1.2: C Dizileri ve KaydÄ±rma Maliyeti</h1>
        <p>Neden Ekleme/Silme Ä°ÅŸlemleri YavaÅŸtÄ±r?</p>
    </header>

    <div class="section">
        <h2>âš ï¸ Problem: BitiÅŸik Bellek (Contiguous Memory)</h2>
        <p>Dizilerin elemanlarÄ± bellekte yan yana, bitiÅŸik durmak zorundadÄ±r. Araya bir eleman eklemek isterseniz, o noktadan sonraki <strong>HERKESÄ°</strong> bir adÄ±m saÄŸa itmeniz gerekir.</p>
        
        <div class="tape-container" id="tape">
            <!-- JS ile doldurulacak -->
        </div>
        
        <div style="text-align: center;">
            <button class="btn btn-run" onclick="animInsert()">â–¶ Araya Ekle (Index 2)</button>
            <button class="btn btn-reset" onclick="animDelete()">â–¶ Aradan Sil (Index 2)</button>
            <button class="btn" onclick="resetTape()">SÄ±fÄ±rla</button>
            <p id="status" style="font-weight:bold; margin-top:15px; color:#2c3e50;">Durum: HazÄ±r</p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ‘¨â€ğŸ’» C Kodu ile Ä°spat</h2>
        <p>Python'da <code>insert()</code> tek satÄ±rdÄ±r ama arka planda (C seviyesinde) ÅŸu iÅŸlem dÃ¶ner:</p>
        
        <div class="code-container">
            <div class="code-header"><span>C Kodu (Low Level Logic)</span></div>
            <pre><code class="language-c">// Bir dizinin 'pos' indeksine 'val' ekleme fonksiyonu
void insert(int arr[], int n, int pos, int val) {
    // 1. Sondan baÅŸlayÄ±p 'pos'a kadar herkesi saÄŸa kaydÄ±r
    //    Bu dÃ¶ngÃ¼ O(N) kez Ã§alÄ±ÅŸÄ±r!
    for (int i = n - 1; i >= pos; i--) {
        arr[i + 1] = arr[i]; 
    }
    
    // 2. AÃ§Ä±lan boÅŸluÄŸa deÄŸeri yaz
    arr[pos] = val; 
}</code></pre>
        </div>
        <p>GÃ¶rdÃ¼ÄŸÃ¼nÃ¼z gibi, <code>for</code> dÃ¶ngÃ¼sÃ¼ veriyi kaydÄ±rmak iÃ§in Ã§alÄ±ÅŸÄ±r. Veri 1 milyon ise, dÃ¶ngÃ¼ 1 milyon kez dÃ¶ner.</p>
    </div>

    <div class="section">
        <h2>ğŸ§ª Python HÄ±z Testi</h2>
        <p>Listenin <strong>baÅŸÄ±na</strong> eleman eklemenin maliyetini Ã¶lÃ§elim.</p>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="runPython('code')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                    <button class="btn" onclick="toggleEdit('code')">âœï¸ DÃ¼zenle</button>
                </div>
            </div>
            
            <pre id="view-code"><code class="language-python">import time

def test_insert(n):
    lst = list(range(n))
    start = time.time()
    # En kÃ¶tÃ¼ senaryo: BaÅŸa ekle (TÃ¼m N eleman kayar)
    lst.insert(0, 999)
    return (time.time() - start) * 1000 # ms

print("--- BAÅA EKLEME (insert(0)) ---")
t1 = test_insert(100_000)
print(f"100k eleman: {t1:.4f} ms")

t2 = test_insert(1_000_000)
print(f"1M   eleman: {t2:.4f} ms")

print(f"\nSonuÃ§: Veri 10 kat arttÄ±, sÃ¼re {t2/t1:.1f} kat arttÄ±!")</code></pre>

            <textarea id="code" class="code-editor">import time

def test_insert(n):
    lst = list(range(n))
    start = time.time()
    # En kÃ¶tÃ¼ senaryo: BaÅŸa ekle
    lst.insert(0, 999)
    return (time.time() - start) * 1000

print("--- BAÅA EKLEME (insert(0)) ---")
t1 = test_insert(100_000)
print(f"100k eleman: {t1:.4f} ms")

t2 = test_insert(1_000_000)
print(f"1M   eleman: {t2:.4f} ms")

print(f"\nSonuÃ§: Veri 10 kat arttÄ±, sÃ¼re {t2/t1:.1f} kat arttÄ±!")</textarea>
            <div id="output-code" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="nav-footer">
        <a href="1a_analiz_giris.html" class="btn">â¬…ï¸ Ã–nceki: Bellek</a>
        <a href="1c_numpy_detay.html" class="btn btn-next">Sonraki: Numpy Detay â¡ï¸</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
<script>
    // --- ANIMATION LOGIC ---
    const tape = document.getElementById('tape');
    const status = document.getElementById('status');
    let data = [10, 20, 30, 40, 50];

    function renderTape() {
        tape.innerHTML = '';
        data.forEach((val, i) => {
            const cell = document.createElement('div');
            cell.className = 'tape-cell';
            cell.id = `cell-${i}`;
            cell.innerHTML = `<span class="idx">${i}</span>${val}`;
            tape.appendChild(cell);
        });
    }

    async function animInsert() {
        if(data.length >= 6) { status.innerText = "âš ï¸ Dizi Ã§ok dolu!"; return; }
        status.innerText = "1. AdÄ±m: Index 2 ve sonrasÄ±nÄ± saÄŸa kaydÄ±r...";
        
        // GÃ¶rsel olarak yer aÃ§mak iÃ§in sondaki elemanlarÄ± kaydÄ±r
        // Sondan index 2'ye kadar olanlarÄ± seÃ§
        for(let i = data.length - 1; i >= 2; i--) {
            const cell = document.getElementById(`cell-${i}`);
            if(cell) cell.classList.add('moving-right');
        }
        
        await new Promise(r => setTimeout(r, 800)); // Animasyon bekle
        
        // MantÄ±ksal gÃ¼ncelleme
        // Array'in arasÄ±na eleman ekle (splice ile simÃ¼le ediyoruz ama C mantÄ±ÄŸÄ± insert)
        data.splice(2, 0, 99);
        
        renderTape(); // Yeniden Ã§iz (KaymÄ±ÅŸ hali)
        
        // Yeni elemanÄ± vurgula
        const newCell = document.getElementById('cell-2');
        newCell.classList.add('new-item');
        status.innerText = "2. AdÄ±m: BoÅŸluÄŸa 99 yazÄ±ldÄ±.";
    }

    async function animDelete() {
        if(data.length <= 2) { status.innerText = "âš ï¸ Silinecek eleman yok!"; return; }
        status.innerText = "1. AdÄ±m: Index 2 (30) siliniyor...";
        
        const target = document.getElementById('cell-2');
        target.classList.add('deleted');
        
        await new Promise(r => setTimeout(r, 600));
        
        status.innerText = "2. AdÄ±m: BoÅŸluÄŸu kapatmak iÃ§in sola kaydÄ±r...";
        
        // SaÄŸdaki tÃ¼m elemanlarÄ± sola kaydÄ±r
        for(let i = 3; i < data.length; i++) {
            const cell = document.getElementById(`cell-${i}`);
            cell.classList.add('moving-left');
        }
        
        await new Promise(r => setTimeout(r, 800));
        
        data.splice(2, 1);
        renderTape();
        status.innerText = "TamamlandÄ±!";
    }

    function resetTape() {
        data = [10, 20, 30, 40, 50];
        renderTape();
        status.innerText = "Durum: HazÄ±r";
    }

    renderTape();

    // --- PYODIDE LOGIC ---
    let pyodideReady = false;
    let pyodide = null;
    async function main() { pyodide = await loadPyodide(); pyodideReady = true; }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor..."); return; }
        const code = document.getElementById(id).value;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) { out.innerText = e; }
    }

    function toggleEdit(id) {
        const view = document.getElementById('view-' + id);
        const editor = document.getElementById(id);
        if (editor.style.display === 'block') { editor.style.display = 'none'; view.style.display = 'block'; }
        else { editor.style.display = 'block'; view.style.display = 'none'; editor.focus(); }
    }
</script>
</body>
</html>