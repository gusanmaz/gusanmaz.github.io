<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9.1: Heap (YÄ±ÄŸÄ±n) Veri YapÄ±sÄ± - DetaylÄ± AnlatÄ±m</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <style>
        .heap-visual {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .tree-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }
        .tree-level {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .tree-level-0 .tree-node { margin: 0 auto; }
        .tree-level-1 .tree-node { margin: 0 40px; }
        .tree-level-2 .tree-node { margin: 0 15px; }
        .tree-level-3 .tree-node { margin: 0 5px; }

        .tree-node {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            color: white;
            position: relative;
            transition: all 0.3s;
        }
        .tree-node .idx {
            position: absolute;
            top: -18px;
            font-size: 10px;
            color: #666;
            background: white;
            padding: 1px 4px;
            border-radius: 3px;
        }
        .tree-node.root { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .tree-node.normal { background: linear-gradient(135deg, #667eea, #764ba2); }
        .tree-node.highlight {
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        .tree-node.new {
            animation: popIn 0.5s ease;
        }
        @keyframes popIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .array-rep {
            display: flex;
            gap: 5px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .array-cell {
            width: 40px;
            height: 40px;
            border: 2px solid #333;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            transition: all 0.3s;
        }
        .array-cell .idx {
            position: absolute;
            top: -18px;
            font-size: 10px;
            color: #666;
        }
        .array-cell.root { background: #e74c3c; color: white; }
        .array-cell.highlight { background: #f39c12; color: white; transform: scale(1.1); }

        .heap-types {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .heap-type {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        .heap-type.max-heap {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            border: 2px solid #e74c3c;
        }
        .heap-type.min-heap {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border: 2px solid #2196f3;
        }

        .formula-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: monospace;
        }
        .formula-box code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .complexity-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .complexity-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
        }
        .complexity-table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .term-box {
            background: linear-gradient(135deg, #667eea15, #764ba215);
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .term-item {
            margin: 15px 0;
            padding-left: 15px;
            border-left: 3px solid #667eea;
        }
        .term-item strong { color: #667eea; }

        .operation-visual {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }
        .controls input {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            width: 80px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ”ï¸ 9.1: Heap (YÄ±ÄŸÄ±n) Veri YapÄ±sÄ±</h1>
        <p>Priority Queue'nun Temel YapÄ±sÄ± - DetaylÄ± AnlatÄ±m</p>
    </header>

    <div class="section">
        <h2>ğŸ“Œ Heap Nedir?</h2>
        <p><strong>Heap</strong>, <a href="5_tree_intro.html" style="color: #667eea;"><strong>tam ikili aÄŸaÃ§ (complete binary tree)</strong></a> ÅŸeklinde dÃ¼zenlenen ve <strong>heap Ã¶zelliÄŸi</strong>ni koruyan Ã¶zel bir veri yapÄ±sÄ±dÄ±r. En Ã¶nemli Ã¶zelliÄŸi: <strong>En bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k elemana O(1)'de eriÅŸim!</strong></p>

        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 4px solid #2196f3; margin: 15px 0;">
            <strong>ğŸ“š Ã–n Bilgi:</strong> Heap'i anlamak iÃ§in aÄŸaÃ§ kavramlarÄ±nÄ± bilmeniz gerekir.
            <a href="5_tree_intro.html" style="color: #1565c0;">AÄŸaÃ§ Temelleri</a> sayfasÄ±nda derinlik, yÃ¼kseklik, complete binary tree gibi kavramlarÄ± Ã¶ÄŸrenebilirsiniz.
        </div>

        <div class="term-box">
            <h4 style="margin-top: 0; color: #667eea;">ğŸ“š Temel Terimler</h4>
            <div class="term-item">
                <strong>Tam Ä°kili AÄŸaÃ§ (Complete Binary Tree):</strong> TÃ¼m seviyeler tamamen dolu, son seviye soldan saÄŸa doldurulur. Bu sayede dizi ile temsil edilebilir!
            </div>
            <div class="term-item">
                <strong>Heap Ã–zelliÄŸi:</strong> Her parent dÃ¼ÄŸÃ¼m, Ã§ocuklarÄ±ndan bÃ¼yÃ¼k (max heap) veya kÃ¼Ã§Ã¼k (min heap) olmalÄ±.
            </div>
            <div class="term-item">
                <strong>Priority Queue:</strong> Ã–ncelik kuyruÄŸu. Her elemana Ã¶ncelik atanÄ±r, en yÃ¼ksek Ã¶ncelikli eleman ilk Ã§Ä±kar. Heap ile O(log n) ekleme/Ã§Ä±karma.
            </div>
        </div>

        <div class="heap-types">
            <div class="heap-type max-heap">
                <h4 style="color: #c62828; margin-top: 0;">ğŸ”º Max Heap (Azami YÄ±ÄŸÄ±n)</h4>
                <p>Her dÃ¼ÄŸÃ¼m â‰¥ Ã§ocuklarÄ±</p>
                <p style="font-size: 2.5em; margin: 15px 0;">KÃ¶k = En BÃ¼yÃ¼k</p>
                <p style="margin: 0; font-family: monospace;">parent(i) â‰¥ child(i)</p>
            </div>
            <div class="heap-type min-heap">
                <h4 style="color: #1565c0; margin-top: 0;">ğŸ”» Min Heap (Asgari YÄ±ÄŸÄ±n)</h4>
                <p>Her dÃ¼ÄŸÃ¼m â‰¤ Ã§ocuklarÄ±</p>
                <p style="font-size: 2.5em; margin: 15px 0;">KÃ¶k = En KÃ¼Ã§Ã¼k</p>
                <p style="margin: 0; font-family: monospace;">parent(i) â‰¤ child(i)</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸŒ³ Heap GÃ¶rselleÅŸtirmesi</h2>

        <div class="heap-visual">
            <h3 style="text-align: center;">Max Heap Ã–rneÄŸi (15 ElemanlÄ±)</h3>

            <div class="tree-container">
                <!-- Seviye 0: KÃ¶k -->
                <div class="tree-level tree-level-0">
                    <div class="tree-node root"><span class="idx">0</span>90</div>
                </div>
                <!-- Seviye 1 -->
                <div class="tree-level tree-level-1">
                    <div class="tree-node normal"><span class="idx">1</span>85</div>
                    <div class="tree-node normal"><span class="idx">2</span>70</div>
                </div>
                <!-- Seviye 2 -->
                <div class="tree-level tree-level-2">
                    <div class="tree-node normal"><span class="idx">3</span>40</div>
                    <div class="tree-node normal"><span class="idx">4</span>80</div>
                    <div class="tree-node normal"><span class="idx">5</span>30</div>
                    <div class="tree-node normal"><span class="idx">6</span>25</div>
                </div>
                <!-- Seviye 3 -->
                <div class="tree-level tree-level-3">
                    <div class="tree-node normal"><span class="idx">7</span>10</div>
                    <div class="tree-node normal"><span class="idx">8</span>35</div>
                    <div class="tree-node normal"><span class="idx">9</span>75</div>
                    <div class="tree-node normal"><span class="idx">10</span>50</div>
                    <div class="tree-node normal"><span class="idx">11</span>20</div>
                    <div class="tree-node normal"><span class="idx">12</span>15</div>
                    <div class="tree-node normal"><span class="idx">13</span>5</div>
                    <div class="tree-node normal"><span class="idx">14</span>22</div>
                </div>
            </div>

            <h4 style="text-align: center; margin-top: 30px;">ğŸ“¦ Dizi Temsili</h4>
            <div class="array-rep">
                <div class="array-cell root"><span class="idx">0</span>90</div>
                <div class="array-cell"><span class="idx">1</span>85</div>
                <div class="array-cell"><span class="idx">2</span>70</div>
                <div class="array-cell"><span class="idx">3</span>40</div>
                <div class="array-cell"><span class="idx">4</span>80</div>
                <div class="array-cell"><span class="idx">5</span>30</div>
                <div class="array-cell"><span class="idx">6</span>25</div>
                <div class="array-cell"><span class="idx">7</span>10</div>
                <div class="array-cell"><span class="idx">8</span>35</div>
                <div class="array-cell"><span class="idx">9</span>75</div>
                <div class="array-cell"><span class="idx">10</span>50</div>
                <div class="array-cell"><span class="idx">11</span>20</div>
                <div class="array-cell"><span class="idx">12</span>15</div>
                <div class="array-cell"><span class="idx">13</span>5</div>
                <div class="array-cell"><span class="idx">14</span>22</div>
            </div>

            <p style="text-align: center; color: #666; margin-top: 10px;">
                Heap tam ikili aÄŸaÃ§ olduÄŸu iÃ§in, dizi ile verimli temsil edilir. Pointer gerekmez!
            </p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ”¢ Ä°ndeks FormÃ¼lleri</h2>
        <p>Heap'i dizi olarak tutarken, parent-child iliÅŸkileri matematiksel formÃ¼llerle bulunur:</p>

        <div class="formula-box">
            <p><strong>i indeksindeki dÃ¼ÄŸÃ¼m iÃ§in (0-tabanlÄ±):</strong></p>
            <ul style="list-style: none; padding-left: 0; margin: 0;">
                <li>ğŸ‘† <strong>Parent indeksi:</strong> <code>(i - 1) // 2</code></li>
                <li>ğŸ‘ˆ <strong>Sol Ã§ocuk indeksi:</strong> <code>2 * i + 1</code></li>
                <li>ğŸ‘‰ <strong>SaÄŸ Ã§ocuk indeksi:</strong> <code>2 * i + 2</code></li>
            </ul>
        </div>

        <div class="code-container">
            <div class="code-header">
                <span>Ä°ndeks Hesaplama Ã–rnekleri</span>
                <button class="btn btn-run" onclick="runPython('code0')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code0"><code class="language-python"># Heap indeks formÃ¼lleri

def parent(i):
    """i'nin parent indeksini dÃ¶ndÃ¼r"""
    return (i - 1) // 2

def left_child(i):
    """i'nin sol Ã§ocuk indeksini dÃ¶ndÃ¼r"""
    return 2 * i + 1

def right_child(i):
    """i'nin saÄŸ Ã§ocuk indeksini dÃ¶ndÃ¼r"""
    return 2 * i + 2

# Heap dizisi
heap = [90, 85, 70, 40, 80, 30, 25, 10, 35, 75, 50, 20, 15, 5, 22]
print(f"Heap: {heap}")
print(f"Boyut: {len(heap)} eleman\n")

# Ã–rnek hesaplamalar
for i in [0, 1, 4, 7]:
    print(f"=== Ä°ndeks {i} (deÄŸer: {heap[i]}) ===")

    p = parent(i)
    l = left_child(i)
    r = right_child(i)

    if i > 0:
        print(f"  Parent: indeks {p} â†’ deÄŸer {heap[p]}")
    else:
        print(f"  Parent: KÃ¶k dÃ¼ÄŸÃ¼m, parent yok")

    if l < len(heap):
        print(f"  Sol Ã§ocuk: indeks {l} â†’ deÄŸer {heap[l]}")
    else:
        print(f"  Sol Ã§ocuk: yok (yaprak dÃ¼ÄŸÃ¼m)")

    if r < len(heap):
        print(f"  SaÄŸ Ã§ocuk: indeks {r} â†’ deÄŸer {heap[r]}")
    else:
        print(f"  SaÄŸ Ã§ocuk: yok")
    print()</code></pre>
            <textarea id="code0" class="code-editor"></textarea>
            <div id="output-code0" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ® Ä°nteraktif Min Heap SimÃ¼lasyonu</h2>

        <div class="heap-visual">
            <div class="tree-container" id="heapTree">
                <!-- JS ile doldurulacak -->
            </div>

            <h4 style="text-align: center;">Dizi Temsili</h4>
            <div class="array-rep" id="heapArray">
                <!-- JS ile doldurulacak -->
            </div>

            <div class="controls">
                <input type="number" id="heapInput" placeholder="DeÄŸer" min="1" max="99">
                <button class="btn btn-run" onclick="heapInsert()">â• Ekle (Push)</button>
                <button class="btn" onclick="heapExtract()">â¬†ï¸ Min Ã‡Ä±kar (Pop)</button>
                <button class="btn btn-reset" onclick="heapReset()">ğŸ”„ SÄ±fÄ±rla</button>
            </div>
            <p id="heapMsg" style="text-align: center; margin-top: 10px; font-weight: bold; min-height: 40px;"></p>
        </div>
    </div>

    <div class="section">
        <h2>âš™ï¸ Temel Ä°ÅŸlemler</h2>

        <div class="operation-visual">
            <h3>1. Insert (Ekleme) - Heapify Up</h3>
            <ol>
                <li><strong>Sona ekle:</strong> Yeni elemanÄ± dizinin sonuna ekle</li>
                <li><strong>Heapify Up:</strong> Parent ile karÅŸÄ±laÅŸtÄ±r
                    <ul>
                        <li>Min Heap: Parent > yeni eleman ise takas</li>
                        <li>Max Heap: Parent < yeni eleman ise takas</li>
                    </ul>
                </li>
                <li><strong>Tekrarla:</strong> KÃ¶ke ulaÅŸana veya heap Ã¶zelliÄŸi saÄŸlanana kadar yukarÄ± Ã§Ä±k</li>
            </ol>
            <p style="margin-bottom: 0;"><strong>KarmaÅŸÄ±klÄ±k:</strong> O(log n) - En fazla aÄŸaÃ§ yÃ¼ksekliÄŸi kadar takas</p>
        </div>

        <div class="operation-visual">
            <h3>2. Extract Min/Max (KÃ¶kÃ¼ Ã‡Ä±karma) - Heapify Down</h3>
            <ol>
                <li><strong>KÃ¶kÃ¼ al:</strong> En Ã¼stteki elemanÄ± kaydet (min veya max)</li>
                <li><strong>Son elemanÄ± kÃ¶ke taÅŸÄ±:</strong> Dizinin son elemanÄ±nÄ± kÃ¶ke koy</li>
                <li><strong>Heapify Down:</strong> Ã‡ocuklarla karÅŸÄ±laÅŸtÄ±r
                    <ul>
                        <li>Min Heap: KÃ¼Ã§Ã¼k Ã§ocukla takas (eÄŸer parent > Ã§ocuk)</li>
                        <li>Max Heap: BÃ¼yÃ¼k Ã§ocukla takas (eÄŸer parent < Ã§ocuk)</li>
                    </ul>
                </li>
                <li><strong>Tekrarla:</strong> Yaprak dÃ¼ÄŸÃ¼me ulaÅŸana veya heap Ã¶zelliÄŸi saÄŸlanana kadar aÅŸaÄŸÄ± in</li>
            </ol>
            <p style="margin-bottom: 0;"><strong>KarmaÅŸÄ±klÄ±k:</strong> O(log n) - En fazla aÄŸaÃ§ yÃ¼ksekliÄŸi kadar takas</p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“Š Zaman KarmaÅŸÄ±klÄ±ÄŸÄ±</h2>

        <table class="complexity-table">
            <thead>
                <tr>
                    <th>Ä°ÅŸlem</th>
                    <th>Zaman</th>
                    <th>AÃ§Ä±klama</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Find Min/Max (Peek)</strong></td>
                    <td style="color: #27ae60; font-weight: bold;">O(1)</td>
                    <td>KÃ¶k her zaman min/max, direkt oku</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td><strong>Insert (Push)</strong></td>
                    <td style="color: #27ae60; font-weight: bold;">O(log n)</td>
                    <td>Sona ekle + heapify up</td>
                </tr>
                <tr>
                    <td><strong>Extract Min/Max (Pop)</strong></td>
                    <td style="color: #27ae60; font-weight: bold;">O(log n)</td>
                    <td>KÃ¶kÃ¼ Ã§Ä±kar + heapify down</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td><strong>Build Heap (Heapify)</strong></td>
                    <td style="color: #27ae60; font-weight: bold;">O(n)</td>
                    <td>AÅŸaÄŸÄ±dan yukarÄ±ya heapify (O(n log n) deÄŸil!)</td>
                </tr>
                <tr>
                    <td><strong>Heap Sort</strong></td>
                    <td style="color: #f39c12; font-weight: bold;">O(n log n)</td>
                    <td>n kez extract iÅŸlemi</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td><strong>Arbitrary Search</strong></td>
                    <td style="color: #e74c3c; font-weight: bold;">O(n)</td>
                    <td>Rastgele eleman arama - heap bunun iÃ§in deÄŸil!</td>
                </tr>
            </tbody>
        </table>

        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 4px solid #2196f3;">
            <strong>ğŸ’¡ Neden O(log n)?</strong>
            <p style="margin: 5px 0 0 0;">Tam ikili aÄŸacÄ±n yÃ¼ksekliÄŸi logâ‚‚(n)'dir. Heapify iÅŸlemleri en fazla yÃ¼kseklik kadar adÄ±m atar.</p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ Python heapq ModÃ¼lÃ¼</h2>
        <p><strong>âš ï¸ Ã–nemli:</strong> Python'un heapq modÃ¼lÃ¼ <strong>sadece Min Heap</strong> destekler!</p>

        <div class="code-container">
            <div class="code-header">
                <span>heapq Temel KullanÄ±m</span>
                <button class="btn btn-run" onclick="runPython('code1')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code1"><code class="language-python">import heapq

# ===== MIN HEAP TEMELLERÄ° =====
print("=== MIN HEAP Ä°ÅLEMLERÄ° ===\n")

# 1. BoÅŸ heap oluÅŸtur (sadece boÅŸ liste!)
heap = []

# 2. Ekleme - heappush(heap, item)
# Her ekleme sonrasÄ± heap Ã¶zelliÄŸi korunur
print("ElemanlarÄ± ekliyoruz:")
for val in [35, 10, 25, 5, 15, 30, 20]:
    heapq.heappush(heap, val)
    print(f"  {val} eklendi â†’ heap: {heap}")

# 3. En kÃ¼Ã§Ã¼ÄŸe bakma (silmeden) - heap[0]
print(f"\nEn kÃ¼Ã§Ã¼k eleman (peek): {heap[0]}")

# 4. En kÃ¼Ã§Ã¼ÄŸÃ¼ Ã§Ä±karma - heappop(heap)
print("\nElemanlarÄ± Ã§Ä±karÄ±yoruz (sÄ±ralÄ± Ã§Ä±kacak!):")
result = []
while heap:
    min_val = heapq.heappop(heap)
    result.append(min_val)
    print(f"  Ã‡Ä±kan: {min_val}, Kalan heap: {heap}")

print(f"\nÃ‡Ä±kÄ±ÅŸ sÄ±rasÄ± (sÄ±ralÄ±!): {result}")</code></pre>
            <textarea id="code1" class="code-editor"></textarea>
            <div id="output-code1" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ”„ Listeden Heap OluÅŸturma</h2>

        <div class="code-container">
            <div class="code-header">
                <span>heapify ve DiÄŸer Fonksiyonlar</span>
                <button class="btn btn-run" onclick="runPython('code2')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code2"><code class="language-python">import heapq

# ===== HEAPIFY - Listeyi Heap'e Ã‡evir =====
print("=== HEAPIFY ===")

# Normal liste
data = [35, 10, 25, 5, 15, 30, 20, 8, 12]
print(f"Orijinal liste: {data}")

# heapify() - Listeyi IN-PLACE heap'e Ã§evirir
# KarmaÅŸÄ±klÄ±k: O(n) - tek tek eklemekten daha hÄ±zlÄ±!
heapq.heapify(data)
print(f"Heapify sonrasÄ±: {data}")
print(f"Minimum: {data[0]}")

# ===== EN BÃœYÃœK/KÃœÃ‡ÃœK N ELEMAN =====
print("\n=== NLARGEST / NSMALLEST ===")

numbers = [64, 34, 25, 12, 22, 11, 90, 45, 78, 55]
print(f"Liste: {numbers}")

# nlargest(n, iterable) - En bÃ¼yÃ¼k n eleman
# nsmallest(n, iterable) - En kÃ¼Ã§Ã¼k n eleman
print(f"En bÃ¼yÃ¼k 3: {heapq.nlargest(3, numbers)}")
print(f"En kÃ¼Ã§Ã¼k 3: {heapq.nsmallest(3, numbers)}")

# ===== HEAPPUSHPOP ve HEAPREPLACE =====
print("\n=== Ã–ZEL FONKSÄ°YONLAR ===")

heap = [5, 10, 15, 20]
heapq.heapify(heap)
print(f"BaÅŸlangÄ±Ã§ heap: {heap}")

# heappushpop(heap, item): Ã–nce ekle, sonra en kÃ¼Ã§Ã¼ÄŸÃ¼ Ã§Ä±kar
# push ve pop'tan daha verimli!
result = heapq.heappushpop(heap, 3)
print(f"heappushpop(3): Ã§Ä±kan={result}, heap={heap}")

# heapreplace(heap, item): Ã–nce en kÃ¼Ã§Ã¼ÄŸÃ¼ Ã§Ä±kar, sonra ekle
result = heapq.heapreplace(heap, 25)
print(f"heapreplace(25): Ã§Ä±kan={result}, heap={heap}")</code></pre>
            <textarea id="code2" class="code-editor"></textarea>
            <div id="output-code2" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ”º Max Heap NasÄ±l YapÄ±lÄ±r?</h2>
        <p>Python heapq sadece min heap destekler. Max heap iÃ§in <strong>negatif deÄŸerler</strong> trick'i kullanÄ±lÄ±r!</p>

        <div class="code-container">
            <div class="code-header">
                <span>Max Heap Wrapper SÄ±nÄ±fÄ±</span>
                <button class="btn btn-run" onclick="runPython('code3')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code3"><code class="language-python">import heapq

class MaxHeap:
    """
    Python heapq min heap olduÄŸu iÃ§in,
    deÄŸerleri negatif yaparak max heap simÃ¼le ederiz.

    MantÄ±k: -90 < -85 < -70 olduÄŸu iÃ§in,
    min heap'te -90 en Ã¼stte olur = aslÄ±nda 90 en bÃ¼yÃ¼k!
    """

    def __init__(self):
        self._heap = []  # Alt Ã§izgi: "private" deÄŸiÅŸken

    def push(self, val):
        """DeÄŸer ekle"""
        # Negatifini ekle
        heapq.heappush(self._heap, -val)

    def pop(self):
        """En bÃ¼yÃ¼k deÄŸeri Ã§Ä±kar ve dÃ¶ndÃ¼r"""
        # Negatifi Ã§Ä±kar, pozitife Ã§evir
        return -heapq.heappop(self._heap)

    def peek(self):
        """En bÃ¼yÃ¼k deÄŸere bak (silmeden)"""
        if self._heap:
            return -self._heap[0]
        return None

    def __len__(self):
        """len() fonksiyonu iÃ§in"""
        return len(self._heap)

    def __bool__(self):
        """bool() dÃ¶nÃ¼ÅŸÃ¼mÃ¼ iÃ§in - boÅŸ mu?"""
        return len(self._heap) > 0

# Test
print("=== MAX HEAP KULLANIMI ===\n")

max_heap = MaxHeap()

# Eklemeler
for val in [35, 10, 90, 25, 5, 70]:
    max_heap.push(val)
    print(f"Push({val}) â†’ En bÃ¼yÃ¼k: {max_heap.peek()}")

print(f"\nHeap boyutu: {len(max_heap)}")

# Ã‡Ä±karmalar
print("\nÃ‡Ä±karmalar (bÃ¼yÃ¼kten kÃ¼Ã§Ã¼ÄŸe):")
while max_heap:  # __bool__ sayesinde Ã§alÄ±ÅŸÄ±r
    print(f"  Pop: {max_heap.pop()}")</code></pre>
            <textarea id="code3" class="code-editor"></textarea>
            <div id="output-code3" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>

        <div class="term-box">
            <h4 style="margin-top: 0; color: #667eea;">ğŸ“ Python Syntax AÃ§Ä±klamalarÄ±</h4>
            <div class="term-item">
                <strong>_ prefix (_heap):</strong> Python'da alt Ã§izgi ile baÅŸlayan deÄŸiÅŸkenler "private" kabul edilir. DÄ±ÅŸarÄ±dan eriÅŸilmemesi gerektiÄŸini belirtir (ama engellemez).
            </div>
            <div class="term-item">
                <strong>__len__(self):</strong> Ã–zel method. <code>len(obj)</code> Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda bu method Ã§alÄ±ÅŸÄ±r.
            </div>
            <div class="term-item">
                <strong>__bool__(self):</strong> Ã–zel method. <code>if obj:</code> veya <code>bool(obj)</code> Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda bu method Ã§alÄ±ÅŸÄ±r.
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ† Heap Sort AlgoritmasÄ±</h2>

        <div class="code-container">
            <div class="code-header">
                <span>Heap Sort Implementasyonu</span>
                <button class="btn btn-run" onclick="runPython('code4')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code4"><code class="language-python">import heapq

def heap_sort(arr):
    """
    Heap Sort - O(n log n) garantili

    Algoritma:
    1. Diziyi heap'e Ã§evir - O(n)
    2. Tek tek Ã§Ä±kar (her Ã§Ä±karma O(log n)) - O(n log n)

    Toplam: O(n log n)
    """
    # 1. Heap oluÅŸtur (in-place)
    heap = arr.copy()
    heapq.heapify(heap)  # O(n)

    # 2. Tek tek Ã§Ä±kar
    result = []
    while heap:
        result.append(heapq.heappop(heap))  # O(log n)

    return result

# Test
original = [64, 34, 25, 12, 22, 11, 90, 45]
print(f"Orijinal: {original}")

sorted_arr = heap_sort(original)
print(f"SÄ±ralÄ±:   {sorted_arr}")

# ===== HEAP SORT Ã–ZELLÄ°KLERÄ° =====
print("\n" + "="*50)
print("HEAP SORT KARÅILAÅTIRMA")
print("="*50)

comparisons = [
    ("Zaman (her durum)", "O(n log n)", "Quick Sort en kÃ¶tÃ¼ O(nÂ²)"),
    ("Alan", "O(1) in-place", "Merge Sort O(n) ek alan"),
    ("Stabilite", "âŒ Stabil deÄŸil", "Merge Sort stabil"),
    ("Cache", "âŒ Cache-unfriendly", "Quick Sort cache-friendly"),
    ("Pratikte", "Genelde yavaÅŸ", "Quick Sort tercih edilir"),
]

for ozellik, heap, karsilastirma in comparisons:
    print(f"\n{ozellik}:")
    print(f"  Heap Sort: {heap}")
    print(f"  Not: {karsilastirma}")</code></pre>
            <textarea id="code4" class="code-editor"></textarea>
            <div id="output-code4" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>

        <div class="term-box">
            <h4 style="margin-top: 0; color: #667eea;">ğŸ“š Terimler AÃ§Ä±klamasÄ±</h4>
            <div class="term-item">
                <strong>In-place:</strong> Ek bellek kullanmadan, mevcut dizi Ã¼zerinde iÅŸlem yapma. Heap sort gerÃ§ek implementasyonda O(1) ek alan kullanÄ±r.
            </div>
            <div class="term-item">
                <strong>Cache-friendly:</strong> CPU Ã¶nbelleÄŸi, ardÄ±ÅŸÄ±k bellek adreslerini Ã¶nceden yÃ¼kler. Heap'te parent-child atlama olduÄŸu iÃ§in cache miss (Ä±skalama) fazla olur â†’ yavaÅŸ.
            </div>
            <div class="term-item">
                <strong>Stabil sÄ±ralama:</strong> EÅŸit deÄŸerli elemanlarÄ±n orijinal sÄ±rasÄ± korunur. Heap sort'ta elemanlar yer deÄŸiÅŸtirirken bu sÄ±ra bozulabilir.
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ§© Pratik Ã–rnekler</h2>

        <h3>Ã–rnek 1: K. En BÃ¼yÃ¼k Eleman</h3>
        <div class="code-container">
            <div class="code-header">
                <span>Kth Largest Element</span>
                <button class="btn btn-run" onclick="runPython('code5')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code5"><code class="language-python">import heapq

def kth_largest(nums, k):
    """
    Dizideki k. en bÃ¼yÃ¼k elemanÄ± bul.

    YÃ¶ntem 1: SÄ±rala ve k. elemanÄ± al - O(n log n)
    YÃ¶ntem 2: Min heap ile - O(n log k)

    Min heap kullanarak: k elemanlÄ± heap tut,
    yeni eleman heap'in minimumundan bÃ¼yÃ¼kse deÄŸiÅŸtir.
    Sonunda heap'in kÃ¶kÃ¼ k. en bÃ¼yÃ¼k!
    """
    # k elemanlÄ± min heap oluÅŸtur
    min_heap = nums[:k]
    heapq.heapify(min_heap)

    # Kalan elemanlarÄ± iÅŸle
    for num in nums[k:]:
        if num > min_heap[0]:  # Heap'in minimumundan bÃ¼yÃ¼kse
            heapq.heapreplace(min_heap, num)  # DeÄŸiÅŸtir

    # Heap'in kÃ¶kÃ¼ k. en bÃ¼yÃ¼k
    return min_heap[0]

# Test
nums = [3, 2, 1, 5, 6, 4]
k = 2
print(f"Dizi: {nums}")
print(f"{k}. en bÃ¼yÃ¼k: {kth_largest(nums, k)}")  # 5

nums2 = [3, 2, 3, 1, 2, 4, 5, 5, 6]
k2 = 4
print(f"\nDizi: {nums2}")
print(f"{k2}. en bÃ¼yÃ¼k: {kth_largest(nums2, k2)}")  # 4</code></pre>
            <textarea id="code5" class="code-editor"></textarea>
            <div id="output-code5" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>

        <h3>Ã–rnek 2: K SÄ±ralÄ± Listeyi BirleÅŸtirme</h3>
        <div class="code-container">
            <div class="code-header">
                <span>Merge K Sorted Lists</span>
                <button class="btn btn-run" onclick="runPython('code6')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
            </div>
            <pre id="view-code6"><code class="language-python">import heapq

def merge_k_lists(lists):
    """
    K adet sÄ±ralÄ± listeyi tek sÄ±ralÄ± listede birleÅŸtir.

    Heap kullanarak O(n log k):
    - Her listeden bir eleman heap'e
    - Her seferinde minimum Ã§Ä±kar, o listeden sonrakini ekle
    """
    result = []

    # (deÄŸer, liste_indeksi, eleman_indeksi) tuple'larÄ±
    # Heap tuple'larÄ± ilk elemana gÃ¶re karÅŸÄ±laÅŸtÄ±rÄ±r
    min_heap = []

    # Her listeden ilk elemanÄ± ekle
    for i, lst in enumerate(lists):
        if lst:  # BoÅŸ liste kontrolÃ¼
            heapq.heappush(min_heap, (lst[0], i, 0))

    while min_heap:
        val, list_idx, elem_idx = heapq.heappop(min_heap)
        result.append(val)

        # O listeden sonraki eleman varsa ekle
        if elem_idx + 1 < len(lists[list_idx]):
            next_val = lists[list_idx][elem_idx + 1]
            heapq.heappush(min_heap, (next_val, list_idx, elem_idx + 1))

    return result

# Test
lists = [
    [1, 4, 5],
    [1, 3, 4],
    [2, 6]
]

print("GiriÅŸ listeleri:")
for i, lst in enumerate(lists):
    print(f"  Liste {i+1}: {lst}")

merged = merge_k_lists(lists)
print(f"\nBirleÅŸik: {merged}")</code></pre>
            <textarea id="code6" class="code-editor"></textarea>
            <div id="output-code6" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸŒ GerÃ§ek Hayat KullanÄ±m AlanlarÄ±</h2>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 20px 0;">
            <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #1565c0;">â­ Priority Queue (Ä°ÅŸletim Sistemleri)</h4>
                <p style="margin-bottom: 0;">Ä°ÅŸlemci zamanlamasÄ±: YÃ¼ksek Ã¶ncelikli process'ler Ã¶nce Ã§alÄ±ÅŸÄ±r. Linux kernel heap kullanÄ±r.</p>
            </div>
            <div style="background: #e8f5e9; padding: 20px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #2e7d32;">ğŸ—ºï¸ Dijkstra AlgoritmasÄ±</h4>
                <p style="margin-bottom: 0;">En kÄ±sa yol bulma: Her adÄ±mda en kÃ¼Ã§Ã¼k mesafeli dÃ¼ÄŸÃ¼mÃ¼ seÃ§. Min heap ile O(E log V).</p>
            </div>
            <div style="background: #fff3e0; padding: 20px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #e65100;">ğŸ“ˆ Running Median</h4>
                <p style="margin-bottom: 0;">Akan veride medyan: Ä°ki heap (max + min) kullanarak O(log n) gÃ¼ncelleme.</p>
            </div>
            <div style="background: #fce4ec; padding: 20px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #c2185b;">ğŸ”§ Huffman Coding</h4>
                <p style="margin-bottom: 0;">Veri sÄ±kÄ±ÅŸtÄ±rma: En az frekansa sahip iki dÃ¼ÄŸÃ¼mÃ¼ birleÅŸtir. Min heap ile verimli.</p>
            </div>
            <div style="background: #f3e5f5; padding: 20px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #7b1fa2;">ğŸ® Event-Driven Simulation</h4>
                <p style="margin-bottom: 0;">Oyun motorlarÄ±: OlaylarÄ± zamana gÃ¶re sÄ±rala, en yakÄ±n olayÄ± iÅŸle.</p>
            </div>
            <div style="background: #e0f7fa; padding: 20px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #00838f;">ğŸ“Š Top-K Problemleri</h4>
                <p style="margin-bottom: 0;">En Ã§ok aranan kelimeler, en yÃ¼ksek puanlÄ± oyuncular, trending topics...</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ†š Heap vs DiÄŸer Veri YapÄ±larÄ±</h2>

        <table class="complexity-table">
            <thead>
                <tr>
                    <th>Ä°ÅŸlem</th>
                    <th>SÄ±rasÄ±z Dizi</th>
                    <th>SÄ±ralÄ± Dizi</th>
                    <th>BST (Dengeli)</th>
                    <th>Heap</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Find Min/Max</td>
                    <td>O(n)</td>
                    <td style="color: #27ae60;">O(1)</td>
                    <td>O(log n)</td>
                    <td style="color: #27ae60; font-weight: bold;">O(1)</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td>Insert</td>
                    <td style="color: #27ae60;">O(1)</td>
                    <td>O(n)</td>
                    <td>O(log n)</td>
                    <td style="color: #27ae60; font-weight: bold;">O(log n)</td>
                </tr>
                <tr>
                    <td>Extract Min/Max</td>
                    <td>O(n)</td>
                    <td style="color: #27ae60;">O(1)*</td>
                    <td>O(log n)</td>
                    <td style="color: #27ae60; font-weight: bold;">O(log n)</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td>Search Arbitrary</td>
                    <td>O(n)</td>
                    <td>O(log n)</td>
                    <td style="color: #27ae60; font-weight: bold;">O(log n)</td>
                    <td style="color: #e74c3c;">O(n)</td>
                </tr>
                <tr>
                    <td>Build from n elements</td>
                    <td>O(n)</td>
                    <td>O(n log n)</td>
                    <td>O(n log n)</td>
                    <td style="color: #27ae60; font-weight: bold;">O(n)</td>
                </tr>
            </tbody>
        </table>
        <p style="font-size: 0.85em; color: #666;">* Sondan Ã§Ä±karma O(1), baÅŸtan Ã§Ä±karma O(n)</p>
    </div>

    <div class="section">
        <h2>ğŸ“‹ Ã–zet</h2>

        <div style="background: #e8f5e9; padding: 25px; border-radius: 10px;">
            <h4 style="margin-top: 0; color: #2e7d32;">âœ… Heap Ne Zaman KullanÄ±lÄ±r?</h4>
            <ul>
                <li><strong>Priority Queue:</strong> Ã–ncelikli iÅŸlem sÄ±rasÄ± gerektiÄŸinde</li>
                <li><strong>Top-K:</strong> En bÃ¼yÃ¼k/kÃ¼Ã§Ã¼k K eleman gerektiÄŸinde</li>
                <li><strong>Medyan:</strong> Akan veride medyan takibi</li>
                <li><strong>Graf AlgoritmalarÄ±:</strong> Dijkstra, Prim algoritmalarÄ±</li>
            </ul>

            <h4 style="color: #c62828; margin-top: 20px;">âŒ Heap Ne Zaman KullanÄ±lmaz?</h4>
            <ul style="margin-bottom: 0;">
                <li><strong>Rastgele arama:</strong> Belirli bir elemanÄ± bulmak O(n)</li>
                <li><strong>SÄ±ralÄ± gezinme:</strong> ElemanlarÄ± sÄ±rayla gezmek iÃ§in uygun deÄŸil</li>
                <li><strong>Range query:</strong> "10-20 arasÄ± elemanlar" gibi sorgular</li>
            </ul>
        </div>
    </div>

    <div class="nav-footer">
        <a href="8a_hash_intro.html" class="btn">â¬…ï¸ Ã–nceki: Hash Table</a>
        <a href="index.html" class="btn" style="background:#e67e22">ğŸ  Ana MenÃ¼</a>
        <a href="index.html" class="btn btn-next">Ana MenÃ¼ye DÃ¶n â¡ï¸</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    // Min Heap SimÃ¼lasyonu
    let heapData = [5, 10, 15, 20, 30, 25, 35];

    function renderHeap() {
        // AÄŸaÃ§ gÃ¶rÃ¼nÃ¼mÃ¼
        const treeContainer = document.getElementById('heapTree');
        treeContainer.innerHTML = '';

        if (heapData.length === 0) {
            treeContainer.innerHTML = '<p style="text-align:center;color:#999;">Heap boÅŸ</p>';
        } else {
            let level = 0;
            let idx = 0;
            while (idx < heapData.length) {
                const levelDiv = document.createElement('div');
                levelDiv.className = `tree-level tree-level-${level}`;

                const nodesInLevel = Math.pow(2, level);
                for (let i = 0; i < nodesInLevel && idx < heapData.length; i++, idx++) {
                    const node = document.createElement('div');
                    node.className = `tree-node ${idx === 0 ? 'root' : 'normal'}`;
                    node.innerHTML = `<span class="idx">${idx}</span>${heapData[idx]}`;
                    levelDiv.appendChild(node);
                }

                treeContainer.appendChild(levelDiv);
                level++;
            }
        }

        // Dizi gÃ¶rÃ¼nÃ¼mÃ¼
        const arrayContainer = document.getElementById('heapArray');
        arrayContainer.innerHTML = '';

        heapData.forEach((val, i) => {
            const cell = document.createElement('div');
            cell.className = `array-cell ${i === 0 ? 'root' : ''}`;
            cell.innerHTML = `<span class="idx">${i}</span>${val}`;
            arrayContainer.appendChild(cell);
        });
    }

    function heapifyUp(i) {
        while (i > 0) {
            const parent = Math.floor((i - 1) / 2);
            if (heapData[i] < heapData[parent]) {
                [heapData[i], heapData[parent]] = [heapData[parent], heapData[i]];
                i = parent;
            } else {
                break;
            }
        }
    }

    function heapifyDown(i) {
        const n = heapData.length;
        while (true) {
            let smallest = i;
            const left = 2 * i + 1;
            const right = 2 * i + 2;

            if (left < n && heapData[left] < heapData[smallest]) smallest = left;
            if (right < n && heapData[right] < heapData[smallest]) smallest = right;

            if (smallest !== i) {
                [heapData[i], heapData[smallest]] = [heapData[smallest], heapData[i]];
                i = smallest;
            } else {
                break;
            }
        }
    }

    function heapInsert() {
        const input = document.getElementById('heapInput');
        const val = parseInt(input.value);

        if (isNaN(val) || val < 1 || val > 99) {
            document.getElementById('heapMsg').innerHTML = 'âš ï¸ 1-99 arasÄ± bir sayÄ± girin!';
            document.getElementById('heapMsg').style.color = '#e74c3c';
            return;
        }

        if (heapData.length >= 15) {
            document.getElementById('heapMsg').innerHTML = 'âš ï¸ Heap dolu (max 15 eleman)';
            document.getElementById('heapMsg').style.color = '#e74c3c';
            return;
        }

        heapData.push(val);
        heapifyUp(heapData.length - 1);
        renderHeap();

        document.getElementById('heapMsg').innerHTML = `âœ… ${val} eklendi, heapify up yapÄ±ldÄ±<br>Min: ${heapData[0]}`;
        document.getElementById('heapMsg').style.color = '#27ae60';
        input.value = '';
    }

    function heapExtract() {
        if (heapData.length === 0) {
            document.getElementById('heapMsg').innerHTML = 'âš ï¸ Heap boÅŸ!';
            document.getElementById('heapMsg').style.color = '#e74c3c';
            return;
        }

        const min = heapData[0];
        heapData[0] = heapData[heapData.length - 1];
        heapData.pop();

        if (heapData.length > 0) {
            heapifyDown(0);
        }

        renderHeap();
        document.getElementById('heapMsg').innerHTML = `â¬†ï¸ Ã‡Ä±karÄ±lan min: <b>${min}</b><br>${heapData.length > 0 ? 'Yeni min: ' + heapData[0] : 'Heap boÅŸ'}`;
        document.getElementById('heapMsg').style.color = '#667eea';
    }

    function heapReset() {
        heapData = [5, 10, 15, 20, 30, 25, 35];
        renderHeap();
        document.getElementById('heapMsg').innerHTML = 'ğŸ”„ Heap sÄ±fÄ±rlandÄ±';
        document.getElementById('heapMsg').style.color = '#667eea';
    }

    renderHeap();

    // Pyodide
    let pyodideReady = false;
    let pyodide = null;
    async function main() { pyodide = await loadPyodide(); pyodideReady = true; }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor, lÃ¼tfen bekleyin..."); return; }
        const code = document.getElementById('view-' + id).textContent;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) { out.innerText = "Hata: " + e; }
    }
</script>
</body>
</html>

