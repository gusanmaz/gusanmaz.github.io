<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.2: Numpy ile Stack</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <style>
        .array-cell { 
            width: 50px; height: 50px; border: 2px solid #333; display: flex; 
            align-items: center; justify-content: center; margin-right: 2px; background: white;
            font-weight: bold;
        }
        .array-cell.active { background: #e8f6f3; border-color: #16a085; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ—ï¸ 2.2: Numpy ile Stack Kodlama</h1>
        <p>DonanÄ±m Seviyesinde Stack MantÄ±ÄŸÄ±</p>
    </header>

    <div class="section" style="background: #e3f2fd; border-left-color: #2196f3;">
        <h2>ğŸ“Œ Ã–n Bilgi: Bu Sayfada Ne Ã–ÄŸreneceÄŸiz?</h2>
        <p>Bu sayfada <strong>sabit boyutlu</strong> bir stack nasÄ±l oluÅŸturulur gÃ¶receÄŸiz. Numpy kullanmamÄ±zÄ±n sebebi, C dilindeki diziler gibi sabit boyutlu, bitiÅŸik bellekte tutulan bir yapÄ± elde etmektir.</p>

        <h4>Neden Sabit Boyutlu Stack?</h4>
        <ul>
            <li>GerÃ§ek dÃ¼nyada (gÃ¶mÃ¼lÃ¼ sistemler, oyun motorlarÄ±) bellek Ã¶nceden ayrÄ±lÄ±r</li>
            <li>Performans kritik uygulamalarda dinamik bellek ayÄ±rma maliyetli olabilir</li>
            <li>Bu Ã¶rnek, stack'in temel mantÄ±ÄŸÄ±nÄ± anlamanÄ±za yardÄ±mcÄ± olacak</li>
        </ul>

        <p><strong>Not:</strong> Pratikte Python'da stack iÃ§in <code>list</code> kullanmak daha yaygÄ±ndÄ±r (bir sonraki ders).</p>
    </div>

    <div class="section">
        <h2>Stack Pointer (Top) GÃ¶rselleÅŸtirme</h2>
        <div style="display: flex; justify-content: center; margin: 20px 0;" id="visual"></div>
        <div style="text-align: center;">
            <button class="btn btn-run" onclick="demoPush()">Sanal Push</button>
            <button class="btn btn-reset" onclick="demoPop()">Sanal Pop</button>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ’» Tam Kod Implementasyonu</h2>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="runPython('code')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                    <button class="btn" onclick="toggleEdit('code')">âœï¸ DÃ¼zenle</button>
                </div>
            </div>
            
            <pre id="view-code"><code class="language-python">import numpy as np

class NumpyStack:
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = np.zeros(capacity, dtype=int)
        self.top = 0
        
    def push(self, value):
        if self.top == self.capacity:
            print("âŒ Dolu!")
            return
        self.data[self.top] = value
        self.top += 1
        print(f"Push({value}) -> {self.data} (Top: {self.top})")
        
    def pop(self):
        if self.top == 0:
            print("âŒ BoÅŸ!")
            return None
        self.top -= 1
        val = self.data[self.top]
        self.data[self.top] = 0 
        print(f"Pop() -> {val}")
        return val

# Test
s = NumpyStack(3)
s.push(10)
s.push(20)
s.push(30)
s.push(40) # Hata!
s.pop()
s.push(99)</code></pre>

            <textarea id="code" class="code-editor">import numpy as np

class NumpyStack:
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = np.zeros(capacity, dtype=int)
        self.top = 0
    def push(self, value):
        if self.top == self.capacity:
            print("âŒ Dolu!")
            return
        self.data[self.top] = value
        self.top += 1
        print(f"Push({value}) -> {self.data} (Top: {self.top})")
    def pop(self):
        if self.top == 0:
            print("âŒ BoÅŸ!")
            return None
        self.top -= 1
        val = self.data[self.top]
        self.data[self.top] = 0 
        print(f"Pop() -> {val}")
        return val

s = NumpyStack(3)
s.push(10)
s.push(20)
s.push(30)
s.push(40) 
s.pop()
s.push(99)</textarea>
            
            <div id="output-code" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="nav-footer">
        <a href="2a_stack_giris.html" class="btn">â¬…ï¸ Ã–nceki: Stack</a>
        <a href="2c_stack_analiz.html" class="btn btn-next">Sonraki: Analiz â¡ï¸</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    // Visual Demo - Sabit deÄŸerlerle daha anlaÅŸÄ±lÄ±r
    let topIdx = 0;
    const cap = 5;
    const container = document.getElementById('visual');
    const sampleValues = [10, 20, 30, 40, 50]; // Sabit, anlaÅŸÄ±lÄ±r deÄŸerler
    let visualData = new Array(cap).fill(0);

    function render() {
        container.innerHTML = '';
        for(let i=0; i<cap; i++) {
            const cell = document.createElement('div');
            cell.className = 'array-cell';
            if (i < topIdx) {
                cell.innerText = visualData[i];
                cell.classList.add('active');
            } else {
                cell.innerText = "-";
            }
            container.appendChild(cell);
        }
        // Top pointer gÃ¶ster
        const topLabel = document.createElement('div');
        topLabel.style.cssText = 'text-align:center; margin-top:10px; font-weight:bold; color:#27ae60;';
        topLabel.innerText = `Top = ${topIdx} (${topIdx === 0 ? 'BoÅŸ' : topIdx === cap ? 'Dolu' : topIdx + ' eleman'})`;
        container.appendChild(topLabel);
    }

    function demoPush() {
        if(topIdx < cap) {
            visualData[topIdx] = sampleValues[topIdx];
            topIdx++;
            render();
        } else {
            alert("âŒ Stack Overflow! (Kapasite: " + cap + ")");
        }
    }

    function demoPop() {
        if(topIdx > 0) {
            topIdx--; 
            visualData[topIdx] = 0;
            render();
        } else {
            alert("âŒ Stack Underflow! (YÄ±ÄŸÄ±n BoÅŸ)");
        }
    }
    
    // BaÅŸlangÄ±Ã§ta render
    render();

    // Pyodide
    let pyodideReady = false;
    let pyodide = null;
    async function main() { pyodide = await loadPyodide(); await pyodide.loadPackage("numpy"); pyodideReady = true; }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor..."); return; }
        const code = document.getElementById(id).value;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) { out.innerText = e; }
    }

    function toggleEdit(id) {
        const view = document.getElementById('view-' + id);
        const editor = document.getElementById(id);
        if (editor.style.display === 'block') { editor.style.display = 'none'; view.style.display = 'block'; }
        else { editor.style.display = 'block'; view.style.display = 'none'; editor.focus(); }
    }
</script>
</body>
</html>