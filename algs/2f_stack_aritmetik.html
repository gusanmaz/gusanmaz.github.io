<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.6: Aritmetik Ä°fadeler</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ§® 2.6: Aritmetik Ä°fadeler ve Stack</h1>
        <p>Polish Notation ve Dijkstra'nÄ±n Ä°ki-Stack AlgoritmasÄ±</p>
    </header>

    <div class="section">
        <h2>3. Dijkstra'nÄ±n Ä°ki-Stack AlgoritmasÄ± (GÃ¶rsel)</h2>
        <p>Ä°fade: <code>( 1 + ( ( 2 + 3 ) * ( 4 * 5 ) ) )</code></p>
        
        <div style="display: flex; gap: 20px; margin: 20px 0; justify-content: center;">
            <div style="border: 2px solid #333; padding: 10px; min-width: 150px; background: white; border-radius: 8px;">
                <h4 style="margin:0 0 10px 0; border-bottom:1px solid #ccc; text-align:center;">Operand Stack</h4>
                <div id="vis-val-stack" style="display: flex; flex-direction: column-reverse; gap: 5px; min-height: 150px;"></div>
            </div>
            <div style="border: 2px solid #333; padding: 10px; min-width: 150px; background: white; border-radius: 8px;">
                <h4 style="margin:0 0 10px 0; border-bottom:1px solid #ccc; text-align:center;">Operator Stack</h4>
                <div id="vis-op-stack" style="display: flex; flex-direction: column-reverse; gap: 5px; min-height: 150px;"></div>
            </div>
        </div>
        
        <div style="text-align: center;">
            <div id="step-desc" style="font-weight: bold; color: #2980b9; margin-bottom: 15px; min-height: 30px;">BaÅŸlamak iÃ§in ilerleyin...</div>
            <button class="btn btn-next" onclick="nextStep()">â¡ï¸ AdÄ±m Ä°lerle</button>
            <button class="btn btn-reset" onclick="resetVis()">SÄ±fÄ±rla</button>
        </div>
    </div>

    <div class="section">
        <h2>4. Kod Ä°le Hesaplama</h2>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="runPython('code2')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                    <button class="btn" onclick="toggleEdit('code2')">âœï¸ DÃ¼zenle</button>
                </div>
            </div>
            
            <pre id="view-code2"><code class="language-python">def evaluate_infix(expression):
    values = []    # SayÄ±lar
    ops = []       # OperatÃ¶rler
    
    tokens = expression.replace('(', ' ( ').replace(')', ' ) ').split()
    
    for token in tokens:
        if token == '(':
            pass # Atla
        elif token in "+-*/":
            ops.append(token)
        elif token == ')':
            # KapanÄ±ÅŸ gelince iÅŸlemi yap
            op = ops.pop()
            val2 = values.pop()
            val1 = values.pop()
            
            if op == '+': res = val1 + val2
            elif op == '-': res = val1 - val2
            elif op == '*': res = val1 * val2
            elif op == '/': res = val1 / val2
            
            values.append(res)
            print(f"Ä°ÅŸlem: {val1} {op} {val2} = {res}")
        else:
            values.append(float(token))
            
    return values.pop()

expr = "( 1 + ( ( 2 + 3 ) * ( 4 * 5 ) ) )"
print(f"SonuÃ§: {evaluate_infix(expr)}")</code></pre>

            <textarea id="code2" class="code-editor">def evaluate_infix(expression):
    values = []
    ops = []
    
    tokens = expression.replace('(', ' ( ').replace(')', ' ) ').split()
    
    for token in tokens:
        if token == '(':
            pass
        elif token in "+-*/":
            ops.append(token)
        elif token == ')':
            op = ops.pop()
            val2 = values.pop()
            val1 = values.pop()
            
            if op == '+': res = val1 + val2
            elif op == '-': res = val1 - val2
            elif op == '*': res = val1 * val2
            elif op == '/': res = val1 / val2
            
            values.append(res)
            print(f"Ä°ÅŸlem: {val1} {op} {val2} = {res}")
        else:
            values.append(float(token))
            
    return values.pop()

expr = "( 1 + ( ( 2 + 3 ) * ( 4 * 5 ) ) )"
print(f"SonuÃ§: {evaluate_infix(expr)}")</textarea>
            
            <div id="output-code2" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="nav-footer">
        <a href="2e_stack_ornekler.html" class="btn">â¬…ï¸ Ã–nceki: Ã–rnekler</a>
        <a href="stack.html" class="btn" style="background:#8e44ad">ğŸ“‹ Stack MenÃ¼</a>
        <a href="3a_queue_giris.html" class="btn btn-next">Sonraki: Queue â¡ï¸</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    let pyodideReady = false;
    let pyodide = null;

    async function main() {
        pyodide = await loadPyodide();
        pyodideReady = true;
    }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor..."); return; }
        const code = document.getElementById(id).value;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) {
            out.innerText = e;
        }
    }

    function toggleEdit(id) {
        const view = document.getElementById('view-' + id);
        const editor = document.getElementById(id);
        if (editor.style.display === 'block') {
            editor.style.display = 'none';
            view.style.display = 'block';
        } else {
            editor.style.display = 'block';
            view.style.display = 'none';
            editor.focus();
        }
    }
    
    // Visualization
    const tokens = ['(', '1', '+', '(', '(', '2', '+', '3', ')', '*', '(', '4', '*', '5', ')', ')', ')'];
    let stepIndex = 0;
    let valStack = [];
    let opStack = [];
    
    function updateVisuals() {
        const valDiv = document.getElementById('vis-val-stack');
        const opDiv = document.getElementById('vis-op-stack');
        valDiv.innerHTML = valStack.map(v => `<div style="background:#3498db; color:white; padding:5px; text-align:center; border-radius:4px;">${v}</div>`).join('');
        opDiv.innerHTML = opStack.map(v => `<div style="background:#e67e22; color:white; padding:5px; text-align:center; border-radius:4px;">${v}</div>`).join('');
    }
    
    function nextStep() {
        if(stepIndex >= tokens.length) {
            document.getElementById('step-desc').innerText = `âœ… SonuÃ§: ${valStack[0]}`;
            return;
        }
        const t = tokens[stepIndex];
        const desc = document.getElementById('step-desc');
        
        if(t === '(') desc.innerText = `ğŸ‘‰ '(' atla.`;
        else if (['+', '*', '-', '/'].includes(t)) {
            opStack.push(t);
            desc.innerText = `ğŸ‘‰ '${t}' Op Stack'e at.`;
        } else if (t === ')') {
            const op = opStack.pop();
            const v2 = valStack.pop();
            const v1 = valStack.pop();
            let res = 0;
            if(op === '+') res = v1 + v2;
            else if(op === '*') res = v1 * v2;
            valStack.push(res);
            desc.innerText = `ğŸ‘‰ ')' geldi: ${v1} ${op} ${v2} = ${res}`;
        } else {
            valStack.push(parseInt(t));
            desc.innerText = `ğŸ‘‰ '${t}' Val Stack'e at.`;
        }
        stepIndex++;
        updateVisuals();
    }
    
    function resetVis() {
        stepIndex = 0; valStack = []; opStack = [];
        document.getElementById('step-desc').innerText = "BaÅŸlamak iÃ§in ilerleyin...";
        updateVisuals();
    }
</script>
</body>
</html>