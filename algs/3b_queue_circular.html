<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3.2: Normal Queue Problemi ve Circular Queue</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>
    <style>
        .clock-container { 
            position: relative; width: 300px; height: 300px; margin: 20px auto; 
            border: 2px dashed #ccc; border-radius: 50%; 
        }
        .cell {
            position: absolute; width: 50px; height: 50px; background: white; border: 2px solid #333;
            border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-weight: bold; font-size: 14px; transition: all 0.3s;
        }
        .cell.filled { background: #1abc9c; color: white; border-color: #16a085; }
        .idx-label { font-size: 10px; color: #666; position: absolute; top: -15px; }

        .array-visual {
            display: flex;
            gap: 2px;
            justify-content: center;
            margin: 15px 0;
            font-family: monospace;
        }
        .array-cell {
            width: 45px;
            height: 45px;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            background: #ecf0f1;
        }
        .array-cell.used { background: #3498db; color: white; }
        .array-cell.head-cell { border-color: #27ae60; border-width: 3px; }
        .array-cell.tail-cell { border-color: #e74c3c; border-width: 3px; }
        .array-cell.wasted { background: #e74c3c; color: white; opacity: 0.5; }

        .pointer-label {
            text-align: center;
            font-size: 12px;
            margin-top: 5px;
        }

        .problem-box {
            background: linear-gradient(135deg, #fff5f5, #fed7d7);
            border: 2px solid #fc8181;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .solution-box {
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            border: 2px solid #68d391;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ”„ 3.2: Normal Queue Problemi ve Circular Queue</h1>
        <p>Neden Dairesel Kuyruk Gerekli?</p>
    </header>

    <!-- YENÄ° BÃ–LÃœM: Normal Queue Problemi -->
    <div class="section">
        <h2>ğŸ¤” Ã–nce Normal (Linear) Queue'yu AnlayalÄ±m</h2>
        <p>Bir diziyi queue olarak kullandÄ±ÄŸÄ±mÄ±zda <strong>head</strong> (baÅŸ) ve <strong>tail</strong> (kuyruk) pointer'larÄ± kullanÄ±rÄ±z:</p>

        <ul>
            <li><strong>head:</strong> Ä°lk elemanÄ±n (Ã§Ä±kacak olanÄ±n) indeksi</li>
            <li><strong>tail:</strong> Yeni elemanÄ±n ekleneceÄŸi indeks</li>
        </ul>

        <div class="code-container">
            <div class="code-header">
                <span>Normal (Linear) Queue - Problem GÃ¶sterimi</span>
                <div>
                    <button class="btn btn-run" onclick="runPython('code-linear')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                    <button class="btn" onclick="toggleEdit('code-linear')">âœï¸ DÃ¼zenle</button>
                </div>
            </div>

            <pre id="view-code-linear"><code class="language-python">import numpy as np

class LinearQueue:
    """
    Normal (Dairesel Olmayan) Queue
    Problem: tail sona ulaÅŸtÄ±ÄŸÄ±nda, baÅŸta yer olsa bile ekleme yapÄ±lamaz!
    """
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = np.zeros(capacity, dtype=int)  # Sabit boyutlu numpy dizisi
        self.head = 0   # Ã‡Ä±kÄ±ÅŸ noktasÄ± (dequeue buradan)
        self.tail = 0   # GiriÅŸ noktasÄ± (enqueue buraya)
        self.size = 0   # Mevcut eleman sayÄ±sÄ±

    def enqueue(self, val):
        # âŒ PROBLEM: tail dizinin sonuna ulaÅŸtÄ±ysa,
        # baÅŸ tarafta boÅŸ yer olsa bile ekleme yapamayÄ±z!
        if self.tail == self.capacity:
            print(f"âŒ Dolu! tail={self.tail} (Dizinin sonuna ulaÅŸÄ±ldÄ±)")
            print(f"   BaÅŸta {self.head} boÅŸ hÃ¼cre var ama kullanamÄ±yoruz!")
            return False

        self.data[self.tail] = val
        self.tail += 1  # Sadece artÄ±rÄ±yoruz, modÃ¼lo YOK
        self.size += 1
        print(f"âœ… Enqueue({val}) -> Dizi: {self.data}, head={self.head}, tail={self.tail}")
        return True

    def dequeue(self):
        if self.size == 0:
            print("âŒ BoÅŸ!")
            return None

        val = self.data[self.head]
        self.data[self.head] = 0  # GÃ¶rsel temizlik (zorunlu deÄŸil)
        self.head += 1  # Sadece artÄ±rÄ±yoruz, modÃ¼lo YOK
        self.size -= 1
        print(f"ğŸ”» Dequeue() -> {val}, Dizi: {self.data}, head={self.head}, tail={self.tail}")
        return val


# ===== PROBLEMÄ° GÃ–STEREN SENARYO =====
print("=" * 60)
print("ğŸ“Œ NORMAL QUEUE PROBLEMÄ°")
print("=" * 60)

q = LinearQueue(5)

# AdÄ±m 1: 3 eleman ekle
print("\n1ï¸âƒ£ ÃœÃ§ eleman ekliyoruz:")
q.enqueue(10)
q.enqueue(20)
q.enqueue(30)

# AdÄ±m 2: 2 eleman Ã§Ä±kar
print("\n2ï¸âƒ£ Ä°ki eleman Ã§Ä±karÄ±yoruz:")
q.dequeue()  # 10 Ã§Ä±kar
q.dequeue()  # 20 Ã§Ä±kar

# AdÄ±m 3: 2 eleman daha ekle
print("\n3ï¸âƒ£ Ä°ki eleman daha ekliyoruz:")
q.enqueue(40)
q.enqueue(50)

# AdÄ±m 4: Bir eleman daha eklemeye Ã§alÄ±ÅŸ
print("\n4ï¸âƒ£ Bir eleman daha eklemeye Ã§alÄ±ÅŸÄ±yoruz:")
q.enqueue(60)  # âŒ BAÅARISIZ! BaÅŸta yer var ama kullanamÄ±yoruz!

print("\n" + "=" * 60)
print("ğŸ“Š SONUÃ‡:")
print(f"   Dizide sadece {q.size} eleman var")
print(f"   Ama {q.head} hÃ¼cre boÅŸa gitti (kullanÄ±lamÄ±yor)!")
print("   Bu hafÄ±za israfÄ±dÄ±r ve 'false overflow' denir.")
print("=" * 60)</code></pre>

            <textarea id="code-linear" class="code-editor">import numpy as np

class LinearQueue:
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = np.zeros(capacity, dtype=int)
        self.head = 0
        self.tail = 0
        self.size = 0

    def enqueue(self, val):
        if self.tail == self.capacity:
            print(f"âŒ Dolu! tail={self.tail} (Dizinin sonuna ulaÅŸÄ±ldÄ±)")
            print(f"   BaÅŸta {self.head} boÅŸ hÃ¼cre var ama kullanamÄ±yoruz!")
            return False
        self.data[self.tail] = val
        self.tail += 1
        self.size += 1
        print(f"âœ… Enqueue({val}) -> Dizi: {self.data}, head={self.head}, tail={self.tail}")
        return True

    def dequeue(self):
        if self.size == 0:
            print("âŒ BoÅŸ!")
            return None
        val = self.data[self.head]
        self.data[self.head] = 0
        self.head += 1
        self.size -= 1
        print(f"ğŸ”» Dequeue() -> {val}, Dizi: {self.data}, head={self.head}, tail={self.tail}")
        return val

q = LinearQueue(5)
q.enqueue(10)
q.enqueue(20)
q.enqueue(30)
q.dequeue()
q.dequeue()
q.enqueue(40)
q.enqueue(50)
q.enqueue(60)  # BaÅŸarÄ±sÄ±z olacak!</textarea>

            <div id="output-code-linear" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ¯ Problemi GÃ¶rselleÅŸtirelim</h2>

        <div class="problem-box">
            <h4 style="margin-top:0; color:#c53030;">âŒ Normal Queue Problemi: "False Overflow"</h4>

            <p><strong>BaÅŸlangÄ±Ã§ durumu (3 eleman eklendi):</strong></p>
            <div class="array-visual">
                <div class="array-cell used head-cell">10</div>
                <div class="array-cell used">20</div>
                <div class="array-cell used tail-cell">30</div>
                <div class="array-cell">-</div>
                <div class="array-cell">-</div>
            </div>
            <div class="pointer-label">head=0, tail=3</div>

            <p><strong>2 eleman Ã§Ä±karÄ±ldÄ±ktan sonra:</strong></p>
            <div class="array-visual">
                <div class="array-cell wasted">ğŸ’€</div>
                <div class="array-cell wasted">ğŸ’€</div>
                <div class="array-cell used head-cell">30</div>
                <div class="array-cell used">40</div>
                <div class="array-cell used tail-cell">50</div>
            </div>
            <div class="pointer-label">head=2, tail=5 (dizinin sonu!)</div>

            <p style="color:#c53030; font-weight:bold;">
                âš ï¸ tail=5 oldu ama dizi boyutu 5. BaÅŸta 2 hÃ¼cre boÅŸ olmasÄ±na raÄŸmen yeni eleman ekleyemiyoruz!
            </p>
        </div>

        <div class="solution-box">
            <h4 style="margin-top:0; color:#276749;">âœ… Ã‡Ã¶zÃ¼m: Circular Queue (ModÃ¼lo ile)</h4>
            <p>Pointer'larÄ± <code>% capacity</code> ile sarmalayarak dizinin baÅŸÄ±na dÃ¶nebiliriz:</p>
            <pre style="background:#2d2d30; color:#9cdcfe; padding:15px; border-radius:8px; margin:10px 0;">
tail = (tail + 1) % capacity  # 5 % 5 = 0 (baÅŸa dÃ¶ner!)
head = (head + 1) % capacity
            </pre>
            <p>Bu sayede dizi <strong>dairesel</strong> olarak kullanÄ±lÄ±r ve hafÄ±za israfÄ± Ã¶nlenir.</p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ”„ Circular Queue GÃ¶rsel SimÃ¼lasyonu</h2>
        <div class="clock-container" id="clock"></div>
        <div style="text-align: center;">
            <button class="btn btn-run" onclick="demoEnqueue()">Enqueue</button>
            <button class="btn btn-reset" onclick="demoDequeue()">Dequeue</button>
            <p id="status" style="margin-top: 10px;">Head: 0, Tail: 0</p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ’» Circular Queue - Numpy Implementasyonu</h2>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="runPython('code')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                    <button class="btn" onclick="toggleEdit('code')">âœï¸ DÃ¼zenle</button>
                </div>
            </div>
            
            <pre id="view-code"><code class="language-python">import numpy as np

class CircularQueue:
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = np.zeros(capacity, dtype=int)
        self.head = 0
        self.tail = 0
        self.size = 0
        
    def enqueue(self, val):
        if self.size == self.capacity:
            print("âŒ GerÃ§ekten dolu! (TÃ¼m hÃ¼creler kullanÄ±mda)")
            return False
        self.data[self.tail] = val
        # ğŸ”‘ MODÃœLO Ä°LE SARMALAMA - dizinin baÅŸÄ±na dÃ¶ner!
        self.tail = (self.tail + 1) % self.capacity
        self.size += 1
        print(f"âœ… Enqueue({val}) -> Dizi: {self.data}, head={self.head}, tail={self.tail}")
        return True

    def dequeue(self):
        if self.size == 0:
            print("âŒ BoÅŸ!")
            return None
        val = self.data[self.head]
        self.data[self.head] = 0
        # ğŸ”‘ MODÃœLO Ä°LE SARMALAMA
        self.head = (self.head + 1) % self.capacity
        self.size -= 1
        print(f"ğŸ”» Dequeue() -> {val}, Dizi: {self.data}, head={self.head}, tail={self.tail}")
        return val

# ===== CIRCULAR QUEUE'NUN AVANTAJINI GÃ–STER =====
print("=" * 60)
print("ğŸ“Œ CIRCULAR QUEUE - AYNI SENARYO")
print("=" * 60)

q = CircularQueue(5)

print("\n1ï¸âƒ£ ÃœÃ§ eleman ekliyoruz:")
q.enqueue(10)
q.enqueue(20)
q.enqueue(30)

print("\n2ï¸âƒ£ Ä°ki eleman Ã§Ä±karÄ±yoruz:")
q.dequeue()
q.dequeue()

print("\n3ï¸âƒ£ Ä°ki eleman daha ekliyoruz:")
q.enqueue(40)
q.enqueue(50)

print("\n4ï¸âƒ£ Åimdi bir eleman daha eklemeye Ã§alÄ±ÅŸalÄ±m:")
q.enqueue(60)  # âœ… BAÅARILI! tail=0'a dÃ¶ndÃ¼!

print("\n5ï¸âƒ£ Hatta bir tane daha ekleyelim:")
q.enqueue(70)  # âœ… BAÅARILI! tail=1'e geÃ§ti!

print("\n" + "=" * 60)
print("ğŸ“Š SONUÃ‡:")
print(f"   Circular Queue ile tÃ¼m {q.capacity} hÃ¼cre kullanÄ±labilir!")
print(f"   Mevcut eleman sayÄ±sÄ±: {q.size}")
print("   HafÄ±za israfÄ± YOK!")
print("=" * 60)</code></pre>

            <textarea id="code" class="code-editor">import numpy as np

class CircularQueue:
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = np.zeros(capacity, dtype=int)
        self.head = 0
        self.tail = 0
        self.size = 0
    def enqueue(self, val):
        if self.size == self.capacity:
            print("âŒ GerÃ§ekten dolu!")
            return False
        self.data[self.tail] = val
        self.tail = (self.tail + 1) % self.capacity  # ModÃ¼lo!
        self.size += 1
        print(f"âœ… Enqueue({val}) -> {self.data}, head={self.head}, tail={self.tail}")
        return True
    def dequeue(self):
        if self.size == 0:
            print("âŒ BoÅŸ!")
            return None
        val = self.data[self.head]
        self.data[self.head] = 0
        self.head = (self.head + 1) % self.capacity  # ModÃ¼lo!
        self.size -= 1
        print(f"ğŸ”» Dequeue() -> {val}, head={self.head}, tail={self.tail}")
        return val

q = CircularQueue(5)
q.enqueue(10)
q.enqueue(20)
q.enqueue(30)
q.dequeue()
q.dequeue()
q.enqueue(40)
q.enqueue(50)
q.enqueue(60)  # Åimdi Ã§alÄ±ÅŸÄ±r!
q.enqueue(70)  # Bu da Ã§alÄ±ÅŸÄ±r!</textarea>

            <div id="output-code" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <!-- KarÅŸÄ±laÅŸtÄ±rma Tablosu -->
    <div class="section">
        <h2>ğŸ“Š Linear vs Circular Queue KarÅŸÄ±laÅŸtÄ±rmasÄ±</h2>
        <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden;">
            <thead>
                <tr style="background: linear-gradient(135deg, #11998e, #38ef7d); color: white;">
                    <th style="padding: 15px;">Ã–zellik</th>
                    <th style="padding: 15px;">Linear Queue</th>
                    <th style="padding: 15px;">Circular Queue</th>
                </tr>
            </thead>
            <tbody>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;"><strong>HafÄ±za KullanÄ±mÄ±</strong></td>
                    <td style="padding: 12px; color: #e74c3c;">âŒ Ä°sraf var (false overflow)</td>
                    <td style="padding: 12px; color: #27ae60;">âœ… Tam verimli</td>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;"><strong>Pointer GÃ¼ncelleme</strong></td>
                    <td style="padding: 12px;"><code>tail++</code></td>
                    <td style="padding: 12px;"><code>tail = (tail+1) % cap</code></td>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;"><strong>Doluluk KontrolÃ¼</strong></td>
                    <td style="padding: 12px;"><code>tail == capacity</code></td>
                    <td style="padding: 12px;"><code>size == capacity</code></td>
                </tr>
                <tr>
                    <td style="padding: 12px;"><strong>Zaman KarmaÅŸÄ±klÄ±ÄŸÄ±</strong></td>
                    <td style="padding: 12px;">O(1)</td>
                    <td style="padding: 12px;">O(1)</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- ModÃ¼lo AritmetiÄŸi AÃ§Ä±klamasÄ± -->
    <div class="section">
        <h2>ğŸ”¢ ModÃ¼lo (%) OperatÃ¶rÃ¼ NasÄ±l Ã‡alÄ±ÅŸÄ±r?</h2>
        <p>ModÃ¼lo, bÃ¶lme iÅŸleminin <strong>kalanÄ±nÄ±</strong> verir ve circular yapÄ±lar iÃ§in mÃ¼kemmeldir:</p>

        <pre style="background: #2d2d30; color: #9cdcfe; padding: 20px; border-radius: 10px; overflow-x: auto;"><code># Kapasite = 5 iken:
0 % 5 = 0  # BaÅŸlangÄ±Ã§
1 % 5 = 1
2 % 5 = 2
3 % 5 = 3
4 % 5 = 4
5 % 5 = 0  # â† Tekrar baÅŸa dÃ¶ndÃ¼!
6 % 5 = 1
7 % 5 = 2
...

# Bu sayede dizi hiÃ§bir zaman "taÅŸmaz",
# sadece baÅŸa dÃ¶ner (wrap-around)</code></pre>

        <p><strong>GerÃ§ek hayat analojisi:</strong> Saat kadranÄ±! 12'den sonra 1'e dÃ¶ner (12 % 12 = 0, sonra 1, 2, 3...).</p>
    </div>

    <div class="nav-footer">
        <a href="3a_queue_giris.html" class="btn">â¬…ï¸ Ã–nceki: Queue</a>
        <a href="3c_queue_python.html" class="btn btn-next">Sonraki: Python â¡ï¸</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    // Visual
    const container = document.getElementById('clock');
    const status = document.getElementById('status');
    const CAP = 8; const RADIUS = 130;
    let head = 0; let tail = 0; let size = 0;
    const items = new Array(CAP).fill(null);

    function initVisual() {
        container.innerHTML = '';
        for(let i=0; i<CAP; i++) {
            const angle = (i * (360 / CAP)) - 90;
            const rad = angle * (Math.PI / 180);
            const x = 150 + RADIUS * Math.cos(rad) - 25;
            const y = 150 + RADIUS * Math.sin(rad) - 25;
            const cell = document.createElement('div');
            cell.className = 'cell'; cell.id = `cell-${i}`;
            cell.style.left = `${x}px`; cell.style.top = `${y}px`;
            cell.innerHTML = `<span class="idx-label">${i}</span><span class="val">-</span>`;
            container.appendChild(cell);
        }
        updatePointers();
    }

    function updatePointers() {
        for(let i=0; i<CAP; i++) {
            const cell = document.getElementById(`cell-${i}`);
            if(items[i] !== null) { cell.classList.add('filled'); cell.querySelector('.val').innerText = items[i]; }
            else { cell.classList.remove('filled'); cell.querySelector('.val').innerText = '-'; }
        }
        status.innerText = `Head: ${head}, Tail: ${tail}, Size: ${size}`;
    }

    function demoEnqueue() {
        if(size < CAP) { items[tail] = String.fromCharCode(65 + Math.floor(Math.random()*26)); tail = (tail + 1) % CAP; size++; updatePointers(); }
    }
    function demoDequeue() {
        if(size > 0) { items[head] = null; head = (head + 1) % CAP; size--; updatePointers(); }
    }
    initVisual();

    // Pyodide
    let pyodideReady = false;
    let pyodide = null;
    async function main() { pyodide = await loadPyodide(); await pyodide.loadPackage("numpy"); pyodideReady = true; }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor..."); return; }
        const code = document.getElementById(id).value;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) { out.innerText = e; }
    }

    function toggleEdit(id) {
        const view = document.getElementById('view-' + id);
        const editor = document.getElementById(id);
        if (editor.style.display === 'block') { editor.style.display = 'none'; view.style.display = 'block'; }
        else { editor.style.display = 'block'; view.style.display = 'none'; editor.focus(); }
    }
</script>
</body>
</html>