<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chimp HafÄ±za Oyunu AtÃ¶lyesi ğŸ’ </title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: #f9f9f9;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        h1, h2, h3 {
            color: #2c3e50;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }
        h1 { font-size: 2.5em; }
        h2 { font-size: 2em; }
        h3 { font-size: 1.5em; margin-top: 30px; }
        code {
            font-family: "Courier New", Courier, monospace;
            background-color: #ecf0f1;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.95em;
        }
        pre {
            background-color: #34495e;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9em;
        }
        .example {
            margin-top: 25px;
            border-top: 2px dashed #bdc3c7;
            padding-top: 25px;
        }
        .interactive-area {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 15px;
        }
        .code-editor {
            flex: 1;
            min-width: 300px;
            height: 400px;
            font-family: "Courier New", Courier, monospace;
            font-size: 14px;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            resize: vertical;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }
        .canvas-container {
            flex-basis: 400px;
            height: 400px;
            background: #f0f0f0;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            overflow: hidden;
        }
        .canvas-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .run-button {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            font-weight: bold;
            color: white;
            background-color: #27ae60;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-top: 10px;
        }
        .run-button:hover {
            background-color: #2ecc71;
        }
        .challenge {
            background-color: #fffbe6;
            border: 1px solid #ffe58f;
            border-radius: 5px;
            padding: 15px;
        }
        .challenge h4 {
            margin-top: 0;
            color: #d98218;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Chimp HafÄ±za Oyunu AtÃ¶lyesi ğŸ’</h1>
        <p>Bu sayfada sadece ÅŸempanze hafÄ±za oyununun (Chimp Test) p5.js ile inÅŸasÄ±na odaklanÄ±yoruz. AÅŸaÄŸÄ±daki Ã¶rnekler, oyunu sÄ±fÄ±rdan kurarken gereken kavramlarÄ± kÃ¼Ã§Ã¼k adÄ±mlarla tanÄ±tÄ±r.</p>

        <h2>AdÄ±mlar</h2>
        <p>Ã–nce kareler ve sayÄ±larÄ± Ã§izmeyi Ã¶ÄŸreneceÄŸiz, ardÄ±ndan Ã§akÄ±ÅŸma kontrolÃ¼, Ã§akÄ±ÅŸmasÄ±z yerleÅŸim, grid yaklaÅŸÄ±mÄ±, oyun dÃ¶ngÃ¼sÃ¼, zamanlama ve en sonda seviye+skora geÃ§eceÄŸiz.</p>

        <div class="example">
            <h3>CH1: Rastgele Kareler (Koordinatlar)</h3>
            <p>Tuvalde <code>n</code> adet rastgele kare yerleÅŸtirir. Kareler tuval dÄ±ÅŸÄ±na taÅŸmaz.</p>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch1">function setup() {
  createCanvas(400, 400);
  background(240);
  stroke(20);
  noFill();

  let n = 10;
  let s = 40;
  for (let i = 0; i < n; i++) {
    let x = random(0, width - s);
    let y = random(0, height - s);
    rect(x, y, s, s);
  }
}

function draw() { noLoop(); }
</textarea>
                <div class="canvas-container" id="canvas-ch1"></div>
            </div>
            <button class="run-button" data-target="code-ch1" data-canvas="canvas-ch1">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
            <div class="challenge">
                <h4>ğŸš€ DeÄŸiÅŸtir ve GÃ¶r</h4>
                <ul>
                    <li><code>n</code> ve <code>s</code> deÄŸerlerini deÄŸiÅŸtirin.</li>
                    <li>Kareleri dolu yapÄ±n: <code>noStroke(); fill(30,150,200,120);</code></li>
                </ul>
            </div>
        </div>

        <div class="example">
            <h3>CH2: Karelerin Ä°Ã§ine Numara YazdÄ±rma</h3>
            <p>Kare merkezine sÄ±ralÄ± sayÄ±lar yazdÄ±rÄ±r. NasÄ±l ortalanÄ±yor?</p>
            <ul>
                <li><b>textAlign(CENTER, CENTER)</b>: Metnin yatay ve dikey referans noktasÄ±nÄ± kare <b>merkezine</b> gÃ¶re alÄ±r.</li>
                <li><b>textSize(s * 0.5)</b>: YazÄ± boyutunu kare boyutunun yarÄ±sÄ± kadar ayarlar.</li>
                <li><b>text(label, x + s/2, y + s/2)</b>: Kare sol-Ã¼st kÃ¶ÅŸe koordinatÄ± <code>(x,y)</code> olduÄŸundan, orta nokta <code>(x + s/2, y + s/2)</code>.</li>
            </ul>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch2">function setup() {
  createCanvas(400, 400);
  background(250);
  stroke(30);
  fill(255);
  textAlign(CENTER, CENTER);

  let n = 8;
  let s = 50;
  textSize(s * 0.5);
  for (let i = 0; i < n; i++) {
    let x = random(0, width - s);
    let y = random(0, height - s);
    rect(x, y, s, s);
    fill(20);
    text(i + 1, x + s / 2, y + s / 2);
    fill(255);
  }
}

function draw() { noLoop(); }
</textarea>
                <div class="canvas-container" id="canvas-ch2"></div>
            </div>
            <button class="run-button" data-target="code-ch2" data-canvas="canvas-ch2">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
        </div>

        <div class="example">
            <h3>CH3: Ã‡akÄ±ÅŸma (Collision) Test Fonksiyonu</h3>
            <p>Ä°ki karenin Ã§akÄ±ÅŸÄ±p Ã§akÄ±ÅŸmadÄ±ÄŸÄ±nÄ± test eder. Her Ã§alÄ±ÅŸtÄ±rmada kareler <b>rastgele</b> seÃ§ilir; sonuÃ§ <b>tuvalin Ã¼zerine</b> yazdÄ±rÄ±lÄ±r.</p>
            <ul>
                <li><b>Fonksiyon Nedir?</b> Tekrar kullanÄ±labilir bir kod bloÄŸu. AdÄ± vardÄ±r, <b>parametreler</b> alÄ±r ve genellikle bir <b>deÄŸer dÃ¶ndÃ¼rÃ¼r</b>. Ã–rn: <code>function f(x, y) { return x + y; }</code></li>
                <li><b>Parametreler</b>: <code>rectsOverlap(ax, ay, aw, ah, bx, by, bw, bh)</code> iÃ§indeki <code>a*</code> A dikdÃ¶rtgenini, <code>b*</code> B dikdÃ¶rtgenini tanÄ±mlar.</li>
                <li><b>Matematik</b> (Ã§akÄ±ÅŸmama durumlarÄ±):
                    <ul>
                        <li>A saÄŸ kenarÄ± â‰¤ B sol kenarÄ±: <code>ax + aw â‰¤ bx</code></li>
                        <li>A sol kenarÄ± â‰¥ B saÄŸ kenarÄ±: <code>ax â‰¥ bx + bw</code></li>
                        <li>A alt kenarÄ± â‰¤ B Ã¼st kenarÄ±: <code>ay + ah â‰¤ by</code></li>
                        <li>A Ã¼st kenarÄ± â‰¥ B alt kenarÄ±: <code>ay â‰¥ by + bh</code></li>
                    </ul>
                    Bu dÃ¶rt durumdan <b>herhangi biri doÄŸruysa</b> dikdÃ¶rtgenler <b>Ã§akÄ±ÅŸmÄ±yor</b> demektir. Fonksiyonda bunlarÄ±n <b>DEÄÄ°L</b>'i alÄ±nÄ±r (<code>!</code>) ve <b>Ã§akÄ±ÅŸma</b> sonucu bulunur.
                </li>
            </ul>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch3">function rectsOverlap(ax, ay, aw, ah, bx, by, bw, bh) {
  return !(ax + aw <= bx || bx + bw <= ax || ay + ah <= by || by + bh <= ay);
}

function setup() {
  createCanvas(400, 300);
  background(240);
  noFill();
  strokeWeight(2);

  // Rastgele iki dikdÃ¶rtgen
  let a = { x: random(20, 220), y: random(20, 160), w: random(60, 140), h: random(40, 120) };
  let b = { x: random(20, 220), y: random(20, 160), w: random(60, 140), h: random(40, 120) };

  // GÃ¶rsel
  stroke(20, 150, 20);
  rect(a.x, a.y, a.w, a.h);
  stroke(200, 40, 40);
  rect(b.x, b.y, b.w, b.h);

  // SonuÃ§
  let overlap = rectsOverlap(a.x, a.y, a.w, a.h, b.x, b.y, b.w, b.h);
  noStroke(); fill(10);
  textAlign(LEFT, TOP); textSize(16);
  text("Ã‡akÄ±ÅŸma: " + (overlap ? "EVET" : "HAYIR"), 10, 10);
  noLoop();
}

function draw() {}
</textarea>
                <div class="canvas-container" id="canvas-ch3"></div>
            </div>
            <button class="run-button" data-target="code-ch3" data-canvas="canvas-ch3">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
            <div class="challenge">
                <h4>ğŸš€ DeÄŸiÅŸtir ve GÃ¶r</h4>
                <ul>
                    <li>Boyut aralÄ±klarÄ±nÄ± deÄŸiÅŸtirip Ã§akÄ±ÅŸma olasÄ±lÄ±ÄŸÄ±nÄ± artÄ±rÄ±n/azaltÄ±n.</li>
                </ul>
            </div>
        </div>

        <div class="example">
            <h3>CH4: Ã‡akÄ±ÅŸmasÄ±z Rastgele Kare Ãœretimi (Dizi + Kontrol)</h3>
            <p>Her yeni kareyi, Ã¶nceki karelerle Ã§akÄ±ÅŸmÄ±yorsa ekle; aksi halde yeni koordinat dene.</p>
            <ul>
                <li><b>Dizi (Array)</b>: Birden fazla Ã¶ÄŸeyi sÄ±rayla tutan yapÄ±. Ã–rn: <code>let sayilar = [10, 20, 30];</code> â€” eriÅŸim: <code>sayilar[0]</code>.</li>
                <li><b>push()</b>: Dizi sonuna Ã¶ÄŸe ekler: <code>sayilar.push(40)</code>.</li>
                <li><b>Fonksiyon</b>: Tekrar kullanÄ±labilir kod bloÄŸu. Ã–rn: <code>function kare(x){ return x*x; }</code></li>
                <li><b>Ã‡akÄ±ÅŸma matematiÄŸi</b>: Ä°ki dikdÃ¶rtgen <code>A(ax,ay,aw,ah)</code>, <code>B(bx,by,bw,bh)</code> iÃ§in Ã§akÄ±ÅŸmama durumlarÄ±: A saÄŸ kenarÄ± â‰¤ B sol kenarÄ±, A sol kenarÄ± â‰¥ B saÄŸ kenarÄ±, A alt kenarÄ± â‰¤ B Ã¼st kenarÄ±, A Ã¼st kenarÄ± â‰¥ B alt kenarÄ±. Bunlardan biri bile doÄŸruysa <b>Ã§akÄ±ÅŸma yok</b>. DeÄŸili alÄ±nÄ±rsa <b>Ã§akÄ±ÅŸma var</b> testi elde edilir.</li>
            </ul>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch4">// DikdÃ¶rtgen Ã§akÄ±ÅŸma testi: Ã§akÄ±ÅŸmama durumlarÄ±nÄ±n DEÄÄ°L'i
function rectsOverlap(ax, ay, aw, ah, bx, by, bw, bh) {
  return !(ax + aw <= bx || bx + bw <= ax || ay + ah <= by || by + bh <= ay);
}

// Ã‡AKIÅMASIZ yerleÅŸim Ã¼reten fonksiyon
function generateNonOverlapping(count, size, maxTry) {
  let rects = [];
  let tries = 0;
  while (rects.length < count && tries < maxTry) {
    tries++;
    let x = random(0, width - size);
    let y = random(0, height - size);
    let ok = true;
    for (const r of rects) {
      if (rectsOverlap(x, y, size, size, r.x, r.y, r.w, r.h)) { ok = false; break; }
    }
    if (ok) rects.push({ x, y, w: size, h: size });
  }
  return rects;
}

function setup() {
  createCanvas(400, 400);
  background(250);
  textAlign(CENTER, CENTER);
  let n = 10, s = 40;
  textSize(s * 0.5);
  let rects = generateNonOverlapping(n, s, 10000);
  stroke(30);
  fill(255);
  for (let i = 0; i < rects.length; i++) {
    let r = rects[i];
    rect(r.x, r.y, r.w, r.h);
    fill(20);
    text(i + 1, r.x + r.w / 2, r.y + r.h / 2);
    fill(255);
  }
}

function draw() { noLoop(); }
</textarea>
                <div class="canvas-container" id="canvas-ch4"></div>
            </div>
            <button class="run-button" data-target="code-ch4" data-canvas="canvas-ch4">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
            <div class="challenge">
                <h4>ğŸš€ DeÄŸiÅŸtir ve GÃ¶r</h4>
                <ul>
                    <li><code>n</code> ve <code>s</code> ile oyna; baÅŸarÄ±sÄ±z yerleÅŸtirme iÃ§in <code>maxTry</code>'Ä± artÄ±r.</li>
                    <li>Kodun baÅŸÄ±na kendi <code>kare(x)</code> fonksiyonunuzu ekleyip Ã§aÄŸÄ±rmayÄ± deneyin.</li>
                </ul>
            </div>
        </div>

        <div class="example">
            <h3>CH5: Grid TabanlÄ± YaklaÅŸÄ±m (EÅŸsiz HÃ¼cre SeÃ§imi)</h3>
            <p>Tuvali hÃ¼crelere bÃ¶ler; <code>k</code> adet farklÄ± hÃ¼creyi seÃ§ip kareleri yerleÅŸtirir. <code>shuffle</code> kullanÄ±r.</p>
            <ul>
                <li><b>push()</b>: Dizi sonuna Ã¶ÄŸe ekler. HÃ¼cre indekslerini toplarken kullanÄ±rÄ±z.</li>
                <li><b>shuffle(dizi, true)</b>: Diziyi yerinde karÄ±ÅŸtÄ±rÄ±r ve rasgele bir sÄ±ra elde etmemizi saÄŸlar.</li>
                <li><b>cell - 12</b>: Karelerin kenarlardan iÃ§eri 6px boÅŸlukla (padding) Ã§izilmesi iÃ§in geniÅŸlikten 12 Ã§Ä±karÄ±lÄ±r (sol 6 + saÄŸ 6).</li>
            </ul>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch5">function setup() {
  createCanvas(400, 400);
  background(245);
  textAlign(CENTER, CENTER);
  let cell = 60;
  let cols = floor(width / cell);
  let rows = floor(height / cell);
  let total = cols * rows;
  let k = 8; // seÃ§ilecek kare sayÄ±sÄ±
  textSize(cell * 0.4);

  let indices = [];
  for (let i = 0; i < total; i++) indices.push(i);
  shuffle(indices, true);
  let chosen = indices.slice(0, k);

  stroke(40);
  fill(255);
  for (let i = 0; i < chosen.length; i++) {
    let id = chosen[i];
    let cx = id % cols;
    let cy = floor(id / cols);
    let x = cx * cell + (cell - cell) / 2;
    let y = cy * cell + (cell - cell) / 2;
    rect(cx * cell + 6, cy * cell + 6, cell - 12, cell - 12);
    fill(20);
    text(i + 1, cx * cell + cell / 2, cy * cell + cell / 2);
    fill(255);
  }
}

function draw() { noLoop(); }
</textarea>
                <div class="canvas-container" id="canvas-ch5"></div>
            </div>
            <button class="run-button" data-target="code-ch5" data-canvas="canvas-ch5">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
        </div>

        <div class="example">
            <h3>CH6: Oyun v1 (Rastgele Koordinatlar, Ã‡akÄ±ÅŸmasÄ±z)</h3>
            <p>SayÄ±lara 5 saniye bakÄ±lÄ±r; sonra kareler gizlenir. DoÄŸru sÄ±rayla tÄ±klayÄ±n.</p>
            <ul>
                <li><b>millis()</b>: Sketch baÅŸladÄ±ÄŸÄ±ndan beri geÃ§en milisaniye sayÄ±sÄ±dÄ±r. <code>startMs = millis()</code> ile baÅŸlangÄ±cÄ± kaydeder, <code>millis() - startMs &gt; revealMs</code> ile sÃ¼re doldu mu kontrol ederiz.</li>
            </ul>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch6">let items = [];
let count = 5;
let sizeS = 56;
let state = "show"; // show, guess, win, lose
let startMs = 0;
let revealMs = 5000;
let expected = 1;
let score = 0;

function rectsOverlap(ax, ay, aw, ah, bx, by, bw, bh) {
  return !(ax + aw <= bx || bx + bw <= ax || ay + ah <= by || by + bh <= ay);
}

function generateNonOverlapping(count, size, maxTry) {
  let rects = [];
  let tries = 0;
  while (rects.length < count && tries < maxTry) {
    tries++;
    let x = random(0, width - size);
    let y = random(0, height - size);
    let ok = true;
    for (const r of rects) {
      if (rectsOverlap(x, y, size, size, r.x, r.y, r.w, r.h)) { ok = false; break; }
    }
    if (ok) rects.push({ x, y, w: size, h: size });
  }
  return rects;
}

function setup() {
  createCanvas(400, 400);
  textAlign(CENTER, CENTER);
  textSize(22);
  resetGame();
}

function resetGame() {
  items = [];
  let rects = generateNonOverlapping(count, sizeS, 10000);
  for (let i = 0; i < rects.length; i++) {
    let r = rects[i];
    items.push({ x: r.x, y: r.y, w: r.w, h: r.h, label: i + 1, clicked: false });
  }
  state = "show";
  expected = 1;
  startMs = millis();
}

function draw() {
  background(250);
  noFill();
  stroke(30);

  if (state === "show") {
    for (const it of items) {
      rect(it.x, it.y, it.w, it.h);
      fill(20);
      text(it.label, it.x + it.w / 2, it.y + it.h / 2);
      fill(255);
    }
    if (millis() - startMs > revealMs) state = "guess";
  } else if (state === "guess") {
    for (const it of items) {
      rect(it.x, it.y, it.w, it.h);
      if (it.clicked) { fill(20); text(it.label, it.x + it.w / 2, it.y + it.h / 2); fill(255); }
    }
  } else if (state === "win") {
    fill(20); noStroke(); textSize(28); text("KazandÄ±nÄ±z! Skor: " + score, width/2, height/2); textSize(22); fill(255);
  } else if (state === "lose") {
    fill(20); noStroke(); textSize(28); text("Oyun Bitti! Skor: " + score, width/2, height/2); textSize(22); fill(255);
  }

  // Ãœst bilgi
  noStroke(); fill(0,80); textSize(14);
  text("Beklenen: " + expected + (state==="show"?" (GÃ–STERÄ°M)":""), width/2, 16);
  fill(255);
}

function mousePressed() {
  if (state !== "guess") return;
  for (const it of items) {
    if (!it.clicked && mouseX >= it.x && mouseX <= it.x + it.w && mouseY >= it.y && mouseY <= it.y + it.h) {
      if (it.label === expected) {
        it.clicked = true;
        score += 10;
        expected++;
        if (expected > count) { score += 100; state = "win"; }
      } else {
        state = "lose";
      }
      break;
    }
  }
}
</textarea>
                <div class="canvas-container" id="canvas-ch6"></div>
            </div>
            <button class="run-button" data-target="code-ch6" data-canvas="canvas-ch6">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
        </div>



        

        <div class="example">
            <h3>CH7: Oyun v2 (Grid YaklaÅŸÄ±mÄ±)</h3>
            <p>Grid hÃ¼crelerinden eÅŸsiz seÃ§im yapar; aynÄ± oyun akÄ±ÅŸÄ±.</p>
            <div class="interactive-area">
                <textarea class="code-editor" id="code-ch8">let items = [];
let cell = 64;
let cols, rows, total;
let k = 6; // kare sayÄ±sÄ±
let state = "show"; // show, guess, win, lose
let startMs = 0;
let revealMs = 5000;
let expected = 1;

function setup() {
  createCanvas(400, 400);
  textAlign(CENTER, CENTER);
  textSize(22);
  cols = floor(width / cell);
  rows = floor(height / cell);
  total = cols * rows;
  initLevel();
}

function initLevel() {
  items = [];
  let ids = [];
  for (let i = 0; i < total; i++) ids.push(i);
  shuffle(ids, true);
  let chosen = ids.slice(0, k).sort((a, b) => a - b);
  for (let i = 0; i < chosen.length; i++) {
    let id = chosen[i];
    let cx = id % cols;
    let cy = floor(id / cols);
    let x = cx * cell + 8;
    let y = cy * cell + 8;
    let s = cell - 16;
    items.push({ x, y, w: s, h: s, label: i + 1, clicked: false });
  }
  state = "show";
  expected = 1;
  startMs = millis();
}

function draw() {
  background(245);
  noFill(); stroke(30);

  if (state === "show") {
    for (const it of items) { rect(it.x, it.y, it.w, it.h); fill(20); text(it.label, it.x + it.w/2, it.y + it.h/2); fill(255); }
    if (millis() - startMs > revealMs) state = "guess";
  } else if (state === "guess") {
    for (const it of items) { rect(it.x, it.y, it.w, it.h); if (it.clicked) { fill(20); text(it.label, it.x + it.w/2, it.y + it.h/2); fill(255);} }
  } else if (state === "win") {
    noStroke(); fill(20); textSize(28); text("KazandÄ±nÄ±z!", width/2, height/2); textSize(22); fill(255);
  } else if (state === "lose") {
    noStroke(); fill(20); textSize(28); text("Oyun Bitti!", width/2, height/2); textSize(22); fill(255);
  }

  noStroke(); fill(0,80); textSize(14); text("Beklenen: " + expected + (state==="show"?" (GÃ–STERÄ°M)":""), width/2, 16); fill(255);
}

function mousePressed() {
  if (state !== "guess") return;
  for (const it of items) {
    if (!it.clicked && mouseX >= it.x && mouseX <= it.x + it.w && mouseY >= it.y && mouseY <= it.y + it.h) {
      if (it.label === expected) { it.clicked = true; expected++; if (expected > k) state = "win"; }
      else { state = "lose"; }
      break;
    }
  }
}
</textarea>
                <div class="canvas-container" id="canvas-ch8"></div>
            </div>
            <button class="run-button" data-target="code-ch8" data-canvas="canvas-ch8">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
        </div>

        <div class="example">
          <h3>CH8: AyrÄ±k HUD + Oyun AlanÄ± (Ã‡akÄ±ÅŸmasÄ±n)</h3>
          <p>Bilgi alanÄ±nÄ± (HUD) Ã¼stte sabit bir ÅŸerit olarak ayÄ±rÄ±r, oyun tahtasÄ±nÄ± altta Ã§izeriz. BÃ¶ylece metinler karelerle Ã§akÄ±ÅŸmaz.</p>
          <div class="interactive-area">
              <textarea class="code-editor" id="code-ch9">let cell = 64;
let hudH = 56; // Ã¼st bilgi alanÄ± yÃ¼ksekliÄŸi
let cols, rows;
let level = 1;
let score = 0;
let state = "show"; // show, guess, win, lose
let revealMs = 4000;
let startMs = 0;
let expected = 1;
let items = [];

function setup() {
createCanvas(400, 400);
textAlign(CENTER, CENTER);
cols = floor(width / cell);
rows = floor((height - hudH) / cell); // sadece board alanÄ± iÃ§in
startLevel();
}

function startLevel() {
items = [];
let k = 3 + (level - 1);
// eÅŸsiz hÃ¼cre seÃ§imi
let ids = [];
for (let i = 0; i < cols * rows; i++) ids.push(i);
shuffle(ids, true);
let chosen = ids.slice(0, k);
chosen.sort((a, b) => a - b);

for (let i = 0; i < chosen.length; i++) {
  let id = chosen[i];
  let cx = id % cols;
  let cy = floor(id / cols);
  // board alanÄ± y-ofseti: hudH
  let pad = 8;
  let x = cx * cell + pad;
  let y = hudH + cy * cell + pad;
  let s = cell - pad * 2;
  items.push({ x, y, w: s, h: s, label: i + 1, clicked: false });
}
expected = 1;
state = "show";
startMs = millis();
}

function drawHUD() {
noStroke();
fill(245);
rect(0, 0, width, hudH);
fill(20);
textSize(14);
text("Seviye: " + level + "  Skor: " + score + "  Beklenen: " + expected + (state==="show"?" (GÃ–STERÄ°M)":""), width/2, hudH/2);
}

function draw() {
background(255);
drawHUD();

// Board alanÄ±
stroke(30); noFill();
if (state === "show") {
  for (const it of items) { rect(it.x, it.y, it.w, it.h); fill(20); textSize(22); text(it.label, it.x + it.w/2, it.y + it.h/2); fill(255); }
  if (millis() - startMs > revealMs) state = "guess";
} else if (state === "guess") {
  for (const it of items) { rect(it.x, it.y, it.w, it.h); if (it.clicked) { fill(20); textSize(22); text(it.label, it.x + it.w/2, it.y + it.h/2); fill(255);} }
} else if (state === "win") {
  noStroke(); fill(20); textSize(20); text("Seviye tamam! SPACE ile devam.", width/2, hudH + (height-hudH)/2);
} else if (state === "lose") {
  noStroke(); fill(20); textSize(20); text("HatalÄ± tÄ±k! R ile yeniden dene.", width/2, hudH + (height-hudH)/2);
}
}

function mousePressed() {
if (state !== "guess") return;
for (const it of items) {
  if (!it.clicked && mouseX >= it.x && mouseX <= it.x + it.w && mouseY >= it.y && mouseY <= it.y + it.h) {
    if (it.label === expected) {
      it.clicked = true;
      score += 10;
      expected++;
      if (expected > items.length) { score += 100; state = "win"; }
    } else {
      state = "lose";
    }
    break;
  }
}
}

function keyPressed() {
if (state === "win" && (key === ' ' || keyCode === 32)) { level++; startLevel(); }
if (key === 'r' || key === 'R') { level = 1; score = 0; startLevel(); }
}
</textarea>
              <div class="canvas-container" id="canvas-ch9"></div>
          </div>
          <button class="run-button" data-target="code-ch9" data-canvas="canvas-ch9">ğŸš€ Ã‡alÄ±ÅŸtÄ±r / DeÄŸiÅŸtir ve GÃ¶r</button>
      </div>


    </div>

    <script>
        function runSketch(code, canvasId) {
            const container = document.getElementById(canvasId);
            container.innerHTML = ""; 
            const iframe = document.createElement('iframe');
            
            const p5LibraryUrl = 'https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js';
            const htmlContent = `
                <html>
                    <head>
                        <script src="${p5LibraryUrl}"><\/script>
                        <style> body { margin: 0; overflow: hidden; } </style>
                    </head>
                    <body>
                        <script>
                            try {
                                ${code}
                            } catch (e) {
                                console.error(e);
                                function setup() {
                                    createCanvas(400, 400);
                                    background(255, 200, 200);
                                    fill(0);
                                    noStroke();
                                    textAlign(LEFT, TOP);
                                    text("Kodunuzda bir hata var:\\n\\n" + e.message, 10, 10);
                                    noLoop();
                                }
                            }
                        <\/script>
                    </body>
                </html>
            `;

            container.appendChild(iframe);
            iframe.contentWindow.document.open();
            iframe.contentWindow.document.write(htmlContent);
            iframe.contentWindow.document.close();
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('.run-button').forEach(button => {
                const targetId = button.dataset.target;
                const canvasId = button.dataset.canvas;
                
                button.addEventListener('click', () => {
                    const code = document.getElementById(targetId).value;
                    runSketch(code, canvasId);
                });

                // Sayfa ilk yÃ¼klendiÄŸinde tÃ¼m Ã¶rnekleri otomatik olarak Ã§alÄ±ÅŸtÄ±r
                const initialCode = document.getElementById(targetId).value;
                runSketch(initialCode, canvasId);
            });
        });
    </script>

</body>
</html>