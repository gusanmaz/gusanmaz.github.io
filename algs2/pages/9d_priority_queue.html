<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>9.4: Priority Queue (Ã–ncelik KuyruÄŸu)</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="../src/main.css" rel="stylesheet" />
    <script type="module">
        import { CodeBlocks } from '../src/code-blocks.js';
        window.CodeBlocks = CodeBlocks;
        document.addEventListener('DOMContentLoaded', () => {
            CodeBlocks.init();
        });
    </script>
    <style>
        .pq-visual {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin: 30px 0;
        }

        .queue-display {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .queue-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            border-radius: 8px;
            border-left: 4px solid #2196f3;
            transition: all 0.3s;
        }

        .queue-item.processing {
            background: linear-gradient(135deg, #fff3e0, #ffebee);
            border-left-color: #ff9800;
            transform: translateX(10px);
        }

        .queue-item.done {
            opacity: 0.5;
            background: #e8f5e9;
            border-left-color: #4caf50;
        }

        .priority-badge {
            min-width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
        }

        .priority-badge.high {
            background: linear-gradient(135deg, #f44336, #c62828);
        }

        .priority-badge.medium {
            background: linear-gradient(135deg, #ff9800, #f57c00);
        }

        .priority-badge.low {
            background: linear-gradient(135deg, #4caf50, #388e3c);
        }

        .item-content {
            flex: 1;
        }

        .item-title {
            font-weight: bold;
            color: #2c3e50;
            font-size: 16px;
        }

        .item-desc {
            color: #666;
            font-size: 14px;
            margin-top: 4px;
        }

        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin: 5px;
        }

        .control-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .control-btn.primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .control-btn.secondary {
            background: #e0e0e0;
            color: #333;
        }
    </style>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10 3a1 1 0 011 1v1a1 1 0 11-2 0V4a1 1 0 011-1zm0 10a3 3 0 100-6 3 3 0 000 6zm0 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM4 10a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm10 0a1 1 0 011-1h1a1 1 0 110 2h-1a1 1 0 01-1-1zM5.05 5.05a1 1 0 011.414 0l.707.707a1 1 0 11-1.414 1.414l-.707-.707a1 1 0 010-1.414zm9.9 9.9a1 1 0 011.414 0l.707.707a1 1 0 11-1.414 1.414l-.707-.707a1 1 0 010-1.414zm-9.9 0a1 1 0 011.414 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707zm9.9-9.9a1 1 0 011.414 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707z"/>
        </svg>
        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
        </svg>
    </button>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
</head>

<body>
    <div class="container">
        <header>
            <h1>â­ 9.4: Priority Queue</h1>
            <p>Heap'in En Ã–nemli KullanÄ±mÄ±!</p>
        </header>

        <div class="section">
            <h2>ğŸ¯ Priority Queue Nedir?</h2>
            <p><strong>Priority Queue</strong>, her elemanÄ±n bir <strong>Ã¶nceliÄŸi</strong> olan kuyruktur. En yÃ¼ksek Ã¶ncelikli eleman her zaman ilk Ã§Ä±kar.</p>

            <div style="background: var(--info-bg); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="margin-top: 0;">ğŸ†š Normal Queue vs Priority Queue</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0;">
                    <div style="background: var(--card-bg); padding: 15px; border-radius: 8px;">
                        <h5>Normal Queue (FIFO)</h5>
                        <p style="font-size: 0.9em;">Ä°lk giren ilk Ã§Ä±kar</p>
                        <code>[5, 2, 9, 1] â†’ 5 Ã§Ä±kar</code>
                    </div>
                    <div style="background: var(--card-bg); padding: 15px; border-radius: 8px;">
                        <h5>Priority Queue</h5>
                        <p style="font-size: 0.9em;">En yÃ¼ksek Ã¶ncelikli Ã§Ä±kar</p>
                        <code>[5, 2, 9, 1] â†’ 9 Ã§Ä±kar â­</code>
                    </div>
                </div>
            </div>

            <div style="background: var(--success-bg); padding: 20px; border-radius: 10px; border-left: 4px solid #4caf50; margin: 20px 0;">
                <h4 style="margin-top: 0; color: #2e7d32;">ğŸŒ GerÃ§ek Hayattan Ã–rnekler</h4>
                <ul style="margin: 10px 0;">
                    <li><strong>Hastane Acil:</strong> AÄŸÄ±r hastalar Ã¶nce (Ã¶ncelik: hastalÄ±k ciddiyeti)</li>
                    <li><strong>Ä°ÅŸletim Sistemi:</strong> Kritik iÅŸler Ã¶nce Ã§alÄ±ÅŸÄ±r (Ã¶ncelik: CPU priority)</li>
                    <li><strong>Dijkstra AlgoritmasÄ±:</strong> En kÄ±sa yol bulma</li>
                    <li><strong>Huffman Encoding:</strong> Veri sÄ±kÄ±ÅŸtÄ±rma</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ¥ Ä°nteraktif SimÃ¼lasyon: Hastane Acil Servisi</h2>
            <p>GerÃ§ek bir hastane acil servisini simÃ¼le edelim! Hastalar Ã¶nceliklerine gÃ¶re sÄ±ralanÄ±r.</p>

            <div class="pq-visual">
                <h3 style="text-align: center; margin-top: 0;">ğŸ§ª Acil Servis Priority Queue</h3>

                <div class="control-panel">
                    <h4 style="margin-top: 0;">Yeni Hasta Ekle</h4>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                        <input type="text" id="patientName" placeholder="Hasta adÄ±" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; flex: 1; min-width: 150px;">
                        <select id="patientPriority" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px;">
                            <option value="1">ğŸ”´ Kritik (1)</option>
                            <option value="2">ğŸŸ  Acil (2)</option>
                            <option value="3">ğŸŸ¡ Orta (3)</option>
                            <option value="4">ğŸŸ¢ Normal (4)</option>
                            <option value="5">âšª Hafif (5)</option>
                        </select>
                        <button class="control-btn primary" onclick="hospitalSim.addPatient()">â• Ekle</button>
                        <button class="control-btn secondary" onclick="hospitalSim.processNext()">ğŸ¥ Muayene Et</button>
                        <button class="control-btn secondary" onclick="hospitalSim.autoProcess()">â© Otomatik</button>
                        <button class="control-btn secondary" onclick="hospitalSim.reset()">ğŸ”„ SÄ±fÄ±rla</button>
                    </div>
                </div>

                <div id="queueStatus" style="background: var(--info-bg); padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #2196f3;">
                    <strong>Durum:</strong> Kuyrukta 0 hasta var
                </div>

                <canvas id="heapCanvas" width="700" height="350"
                    style="border: 2px solid #e0e0e0; border-radius: 10px; background: white; display: block; margin: 20px auto;"></canvas>

                <div id="queueDisplay" class="queue-display"></div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ’» Priority Queue Ä°mplementasyonu</h2>

            <div class="code-container">
                <div class="code-header">
                    <span>Priority Queue with Heap</span>
                    <button class="btn btn-run" onclick="CodeBlocks.run('code1')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                </div>
                <pre id="view-code1"><code class="language-python line-numbers">class PriorityQueue:
    """Min Heap ile Priority Queue (en kÃ¼Ã§Ã¼k Ã¶ncelikli Ã¶nce Ã§Ä±kar)"""

    def __init__(self):
        self.heap = []

    def parent(self, i):
        return (i - 1) // 2

    def left(self, i):
        return 2 * i + 1

    def right(self, i):
        return 2 * i + 2

    def swap(self, i, j):
        self.heap[i], self.heap[j] = self.heap[j], self.heap[i]

    def push(self, priority, data):
        """Eleman ekle - O(log n)"""
        item = (priority, data)
        self.heap.append(item)
        self._bubble_up(len(self.heap) - 1)
        print(f"â• Push: Priority={priority}, Data={data}")

    def _bubble_up(self, i):
        """YukarÄ± yÃ¼zdÃ¼r"""
        while i > 0:
            parent_idx = self.parent(i)
            if self.heap[i][0] < self.heap[parent_idx][0]:
                self.swap(i, parent_idx)
                i = parent_idx
            else:
                break

    def pop(self):
        """En yÃ¼ksek Ã¶ncelikli elemanÄ± Ã§Ä±kar - O(log n)"""
        if not self.heap:
            return None

        if len(self.heap) == 1:
            item = self.heap.pop()
            print(f"â– Pop: Priority={item[0]}, Data={item[1]}")
            return item[1]

        # Root'u kaydet
        min_item = self.heap[0]

        # Son elemanÄ± root'a taÅŸÄ±
        self.heap[0] = self.heap.pop()
        self._bubble_down(0)

        print(f"â– Pop: Priority={min_item[0]}, Data={min_item[1]}")
        return min_item[1]

    def _bubble_down(self, i):
        """AÅŸaÄŸÄ± batÄ±r"""
        while True:
            left = self.left(i)
            right = self.right(i)
            smallest = i

            if left < len(self.heap) and self.heap[left][0] < self.heap[smallest][0]:
                smallest = left

            if right < len(self.heap) and self.heap[right][0] < self.heap[smallest][0]:
                smallest = right

            if smallest != i:
                self.swap(i, smallest)
                i = smallest
            else:
                break

    def peek(self):
        """En yÃ¼ksek Ã¶ncelikli elemana bak - O(1)"""
        if self.heap:
            return self.heap[0][1]
        return None

    def is_empty(self):
        return len(self.heap) == 0

    def size(self):
        return len(self.heap)

# Test: Hastane Acil Servisi
print("=== ğŸ¥ Hastane Acil Servisi SimÃ¼lasyonu ===\n")

pq = PriorityQueue()

# Hastalar geldi (Ã¶ncelik: 1=kritik, 5=hafif)
print("Hastalar acile geldi:")
pq.push(3, "Ali (kÄ±rÄ±k kol)")
pq.push(1, "AyÅŸe (kalp krizi)") # En kritik!
pq.push(5, "Mehmet (nezle)")
pq.push(2, "Fatma (yanÄ±k)")
pq.push(4, "Can (baÅŸ aÄŸrÄ±sÄ±)")

print(f"\nKuyrukta {pq.size()} hasta var")
print(f"SÄ±radaki: {pq.peek()}")

# HastalarÄ± sÄ±rayla muayene et
print("\n=== Muayene SÄ±rasÄ± ===")
while not pq.is_empty():
    hasta = pq.pop()
    print(f"  â†’ {hasta} muayene ediliyor")

print("\nâœ… TÃ¼m hastalar muayene edildi!")</code></pre>
                <div id="output-code1" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ Python'da Priority Queue</h2>

            <div class="code-container">
                <div class="code-header">
                    <span>Python heapq ModÃ¼lÃ¼</span>
                    <button class="btn btn-run" onclick="CodeBlocks.run('code2')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                </div>
                <pre id="view-code2"><code class="language-python line-numbers">import heapq

# Python heapq kullanÄ±mÄ±
print("=== Python heapq (Min Heap) ===\n")

# Priority Queue oluÅŸtur
pq = []

# Eleman ekle: (Ã¶ncelik, veri)
heapq.heappush(pq, (3, "GÃ¶rev C"))
heapq.heappush(pq, (1, "GÃ¶rev A - Ã–NEMLÄ°!"))
heapq.heappush(pq, (2, "GÃ¶rev B"))
heapq.heappush(pq, (1, "GÃ¶rev A2 - Ã–NEMLÄ°!"))

print(f"Priority Queue: {pq}")

# ElemanlarÄ± Ã§Ä±kar (Ã¶ncelik sÄ±rasÄ±nda)
print("\n=== GÃ¶revler SÄ±rayla ===")
while pq:
    priority, task = heapq.heappop(pq)
    print(f"Ã–ncelik {priority}: {task}")

# Max Heap iÃ§in trick: Negatif kullan!
print("\n=== Max Heap (Negatif Trick) ===")
max_heap = []

# Negatif Ã¶ncelik ekle
heapq.heappush(max_heap, (-10, "A"))
heapq.heappush(max_heap, (-30, "C"))
heapq.heappush(max_heap, (-20, "B"))

print("Max Heap (negatif):", max_heap)

while max_heap:
    neg_priority, data = heapq.heappop(max_heap)
    priority = -neg_priority  # Geri Ã§evir
    print(f"Ã–ncelik {priority}: {data}")

# Ã–nemli: heapq SADECE min heap!
# Max heap iÃ§in negatif kullan veya kendi sÄ±nÄ±f yaz</code></pre>
                <div id="output-code2" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
            </div>
        </div>

        <div class="section">
            <h2>ğŸ“Š Priority Queue KarmaÅŸÄ±klÄ±k</h2>

            <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                <thead>
                    <tr style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                        <th style="padding: 12px; text-align: left;">Ä°ÅŸlem</th>
                        <th style="padding: 12px;">Heap</th>
                        <th style="padding: 12px;">SÄ±ralÄ± Dizi</th>
                        <th style="padding: 12px;">SÄ±rasÄ±z Dizi</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background: var(--secondary-bg);">
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Push</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #4caf50;">O(log n) âœ…</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">O(n)</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">O(1)</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Pop (min/max)</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #4caf50;">O(log n) âœ…</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">O(1)</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">O(n)</td>
                    </tr>
                    <tr style="background: var(--secondary-bg);">
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Peek</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center; color: #4caf50;">O(1) âœ…</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">O(1)</td>
                        <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">O(n)</td>
                    </tr>
                </tbody>
            </table>

            <p style="font-size: 0.9em; color: #666;">Heap her iki iÅŸlemde de dengeli performans â†’ En iyi seÃ§im!</p>
        </div>

        <div class="section">
            <h2>ğŸ“‹ Ã–zet</h2>
            <div style="background: var(--success-bg); padding: 25px; border-radius: 10px;">
                <h4 style="margin-top: 0; color: #2e7d32;">âœ… Bu BÃ¶lÃ¼mde Ã–ÄŸrendikleriniz</h4>
                <ul>
                    <li><strong>Priority Queue:</strong> En yÃ¼ksek/dÃ¼ÅŸÃ¼k Ã¶ncelikli eleman Ã¶nce Ã§Ä±kar</li>
                    <li><strong>Heap ideal:</strong> Push O(log n), Pop O(log n), Peek O(1)</li>
                    <li><strong>Python heapq:</strong> Min heap (max iÃ§in negatif kullan)</li>
                    <li><strong>KullanÄ±m:</strong> Task scheduling, Dijkstra, Huffman, OS...</li>
                    <li><strong>Ä°nteraktif simÃ¼lasyon:</strong> Hastane acil servisi Ã¶rneÄŸi ile priority queue mantÄ±ÄŸÄ±nÄ± gÃ¶rdÃ¼nÃ¼z</li>
                </ul>
            </div>
        </div>

        <div class="nav-footer" data-auto-nav></div>
    </div>
    
</body>
</html>

    <script src="../src/main.js"></script>
    <script src="../src/visualizations.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
