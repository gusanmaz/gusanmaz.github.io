<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6.2: Ä°kili Arama (Binary Search)</title>

    <!-- Unified CSS -->
    <link rel="stylesheet" href="../src/main.css">

    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
    <style>

        .search-container {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .array-visual {
            display: flex;
            gap: 3px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
            position: relative;
        }
        .array-cell {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #333;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            background: var(--card-bg);
            transition: all 0.3s;
            position: relative;
        }
        .array-cell .index {
            position: absolute;
            top: -18px;
            font-size: 10px;
            color: var(--text-secondary);
        }
        .array-cell.active {
            background: #3498db;
            color: white;
            border-color: #2980b9;
        }
        .array-cell.mid {
            background: #f39c12;
            color: white;
            transform: scale(1.15);
            border-color: #e67e22;
        }
        .array-cell.found {
            background: #27ae60;
            color: white;
            transform: scale(1.2);
            box-shadow: 0 0 20px rgba(39, 174, 96, 0.5);
        }
        .array-cell.eliminated {
            background: #ecf0f1;
            color: #bdc3c7;
            border-color: #bdc3c7;
        }
        .array-cell.low { border-bottom: 4px solid #27ae60; }
        .array-cell.high { border-bottom: 4px solid #e74c3c; }

        .pointer-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            font-weight: bold;
        }
        .pointer-label {
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
        }
        .pointer-label.low { background: #27ae60; }
        .pointer-label.mid { background: #f39c12; }
        .pointer-label.high { background: #e74c3c; }

        .complexity-compare {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .compare-card {
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        .compare-card.linear {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        .compare-card.binary {
            background: linear-gradient(135deg, #27ae60, #1e8449);
            color: white;
        }

        .step-log {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            max-height: 200px;
            overflow-y: auto;
            margin: 15px 0;
        }
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
        }
        .controls input {
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            width: 100px;
        }

        .formula-box {
            background: linear-gradient(135deg, #667eea15, #764ba215);
            border: 2px solid #667eea;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
        }
        .formula {
            font-size: 1.5em;
            font-family: 'Times New Roman', serif;
            color: #667eea;
            margin: 15px 0;
        }
        </style>
</head>

<body>


<div class="container">
        <!-- Theme Toggle -->
        <button class="theme-toggle" aria-label="Toggle theme">ğŸŒ™</button>

    <header>
        <h1>ğŸ¯ 6.2: Ä°kili Arama (Binary Search)</h1>
        <p>BÃ¶l ve Fethet ile Logaritmik HÄ±z</p>
    </header>

    <div class="section">
        <h2>ğŸ“Œ Binary Search Nedir?</h2>
        <p><strong>Ä°kili Arama (Binary Search)</strong>, <em>sÄ±ralÄ±</em> bir dizide aranan elemanÄ± bulmak iÃ§in diziyi sÃ¼rekli ikiye bÃ¶len Ã§ok verimli bir algoritmadÄ±r.</p>

        <div class="formula-box">
            <h4 style="margin-top: 0;">ğŸ”‘ Temel Fikir: BÃ¶l ve Fethet (Divide & Conquer)</h4>
            <p>Her adÄ±mda arama alanÄ± yarÄ±ya iner!</p>
            <div class="formula">
                mid = (low + high) // 2
            </div>
            <p>1.000.000 elemanlÄ± dizide sadece <strong>~20 karÅŸÄ±laÅŸtÄ±rma</strong> yeterli!</p>
        </div>

        <div style="background: #fff3cd; padding: 20px; border-radius: 10px; border-left: 4px solid #ffc107;">
            <h4 style="margin-top: 0; color: #856404;">âš ï¸ Ã–NEMLÄ°: Ã–n KoÅŸul</h4>
            <p style="margin: 0;"><strong>Binary Search sadece SIRALI dizilerde Ã§alÄ±ÅŸÄ±r!</strong></p>
            <p style="margin: 5px 0 0 0;">Dizi sÄ±ralÄ± deÄŸilse Ã¶nce sÄ±ralamanÄ±z gerekir (O(n log n) maliyet).</p>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ¬ Algoritma AdÄ±mlarÄ±</h2>
        <ol>
            <li><strong>BaÅŸlangÄ±Ã§:</strong> low = 0, high = n-1 (tÃ¼m dizi)</li>
            <li><strong>Orta noktayÄ± bul:</strong> mid = (low + high) // 2</li>
            <li><strong>KarÅŸÄ±laÅŸtÄ±r:</strong>
                <ul>
                    <li>arr[mid] == target â†’ BULUNDU! mid dÃ¶ndÃ¼r</li>
                    <li>arr[mid] > target â†’ SaÄŸ yarÄ±yÄ± ele (high = mid - 1)</li>
                    <li>arr[mid] < target â†’ Sol yarÄ±yÄ± ele (low = mid + 1)</li>
                </ul>
            </li>
            <li><strong>Tekrarla:</strong> low â‰¤ high olduÄŸu sÃ¼rece 2-3 adÄ±mlarÄ±nÄ± tekrarla</li>
            <li><strong>BulunamadÄ±:</strong> low > high olunca -1 dÃ¶ndÃ¼r</li>
        </ol>
    </div>

    <div class="search-container">
        <h3>ğŸ® Ä°nteraktif Binary Search SimÃ¼lasyonu</h3>
        <p style="text-align: center; color: #666;">SÄ±ralÄ± Dizi (15 eleman): [5, 11, 15, 22, 28, 34, 41, 45, 52, 58, 64, 71, 78, 85, 90]</p>

        <div class="array-visual" id="arrayVisual">
            <!-- JS ile doldurulacak -->
        </div>

        <div id="pointerInfo" style="text-align: center; margin: 10px 0; font-family: monospace;">
            <!-- Pointer bilgileri -->
        </div>

        <div class="controls">
            <input type="number" id="searchValue" placeholder="Ara..." min="1" max="99">
            <button class="btn btn-run" onclick="startBinarySearch()">ğŸ” Ara</button>
            <button class="btn" onclick="stepSearch()">â­ï¸ AdÄ±m</button>
            <button class="btn btn-reset" onclick="resetSearch()">ğŸ”„ SÄ±fÄ±rla</button>
        </div>

        <div class="step-log" id="stepLog">
            ğŸ¯ Bir sayÄ± girin ve "Ara" butonuna tÄ±klayÄ±n...
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“Š KarmaÅŸÄ±klÄ±k Analizi</h2>

        <div class="complexity-compare">
            <div class="compare-card linear">
                <h3 style="margin-top: 0;">ğŸ¢ Lineer Arama</h3>
                <p style="font-size: 3em; margin: 15px 0;">O(n)</p>
                <p>1.000.000 eleman = 1.000.000 karÅŸÄ±laÅŸtÄ±rma</p>
            </div>
            <div class="compare-card binary">
                <h3 style="margin-top: 0;">ğŸš€ Binary Search</h3>
                <p style="font-size: 3em; margin: 15px 0;">O(log n)</p>
                <p>1.000.000 eleman = ~20 karÅŸÄ±laÅŸtÄ±rma</p>
            </div>
        </div>

        <h3>Neden logâ‚‚(n)?</h3>
        <p>Her adÄ±mda arama alanÄ± yarÄ±ya iniyor:</p>
        <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
            <thead>
                <tr style="background: #667eea; color: white;">
                    <th style="padding: 12px;">AdÄ±m</th>
                    <th style="padding: 12px;">Kalan Eleman</th>
                    <th style="padding: 12px;">FormÃ¼l</th>
                </tr>
            </thead>
            <tbody>
                <tr><td style="padding: 10px; border: 1px solid #ddd;">0</td><td style="padding: 10px; border: 1px solid #ddd;">n</td><td style="padding: 10px; border: 1px solid #ddd;">n / 2â°</td></tr>
                <tr style="background: #f8f9fa;"><td style="padding: 10px; border: 1px solid #ddd;">1</td><td style="padding: 10px; border: 1px solid #ddd;">n/2</td><td style="padding: 10px; border: 1px solid #ddd;">n / 2Â¹</td></tr>
                <tr><td style="padding: 10px; border: 1px solid #ddd;">2</td><td style="padding: 10px; border: 1px solid #ddd;">n/4</td><td style="padding: 10px; border: 1px solid #ddd;">n / 2Â²</td></tr>
                <tr style="background: #f8f9fa;"><td style="padding: 10px; border: 1px solid #ddd;">k</td><td style="padding: 10px; border: 1px solid #ddd;">n/2áµ = 1</td><td style="padding: 10px; border: 1px solid #ddd;">k = logâ‚‚(n)</td></tr>
            </tbody>
        </table>
    </div>

    <div class="section">
        <h2>ğŸ’» Python ImplementasyonlarÄ±</h2>

        <h3>1. Iteratif (DÃ¶ngÃ¼ ile)</h3>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="CodeBlocks.run(\'code1\')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                </div>
            </div>
            <pre id="view-code1"><code class="language-python line-numbers">def binary_search_iterative(arr, target):
    """
    Ä°kili Arama - Iteratif YÃ¶ntem

    Args:
        arr: SIRALI dizi
        target: Aranan deÄŸer

    Returns:
        Bulunursa indeks, bulunamazsa -1
    """
    low = 0
    high = len(arr) - 1
    step = 0

    while low <= high:
        step += 1
        mid = (low + high) // 2

        print(f"AdÄ±m {step}: low={low}, high={high}, mid={mid}")
        print(f"         arr[{mid}] = {arr[mid]}")

        if arr[mid] == target:
            print(f"         âœ… BULUNDU!")
            return mid
        elif arr[mid] < target:
            print(f"         {arr[mid]} < {target} â†’ SaÄŸa git")
            low = mid + 1
        else:
            print(f"         {arr[mid]} > {target} â†’ Sola git")
            high = mid - 1

    print("âŒ BulunamadÄ±!")
    return -1

# Test
dizi = [11, 12, 22, 25, 34, 45, 64, 78, 90]
print(f"SÄ±ralÄ± Dizi: {dizi}")
print(f"Aranan: 45\n")

sonuc = binary_search_iterative(dizi, 45)
print(f"\nSonuÃ§: Ä°ndeks = {sonuc}")</code></pre>
            <div id="output-code1" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>

        <h3>2. Recursive (Ã–zyinelemeli)</h3>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="CodeBlocks.run(\'code2\')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                </div>
            </div>
            <pre id="view-code2"><code class="language-python line-numbers">def binary_search_recursive(arr, target, low, high, step=1):
    """
    Ä°kili Arama - Recursive YÃ¶ntem
    """
    if low > high:
        return -1

    mid = (low + high) // 2
    print(f"AdÄ±m {step}: arr[{mid}] = {arr[mid]} {'âœ…' if arr[mid] == target else ''}")

    if arr[mid] == target:
        return mid
    elif arr[mid] < target:
        return binary_search_recursive(arr, target, mid + 1, high, step + 1)
    else:
        return binary_search_recursive(arr, target, low, mid - 1, step + 1)

# Test
dizi = [11, 12, 22, 25, 34, 45, 64, 78, 90]
print(f"SÄ±ralÄ± Dizi: {dizi}")
print(f"Aranan: 22\n")

sonuc = binary_search_recursive(dizi, 22, 0, len(dizi) - 1)
print(f"\nSonuÃ§: Ä°ndeks = {sonuc}")

print("\n" + "="*40)
print("Recursive vs Iterative:")
print("- Recursive: Daha okunaklÄ±, ama call stack kullanÄ±r")
print("- Iterative: Daha verimli (O(1) ek alan)")</code></pre>
            <div id="output-code2" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>

        <h3>3. Python bisect ModÃ¼lÃ¼</h3>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="CodeBlocks.run(\'code3\')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                </div>
            </div>
            <pre id="view-code3"><code class="language-python line-numbers">import bisect

dizi = [11, 12, 22, 25, 34, 45, 64, 78, 90]
print(f"SÄ±ralÄ± Dizi: {dizi}")

# bisect_left: ElemanÄ±n eklenmesi gereken sol pozisyon
pos = bisect.bisect_left(dizi, 45)
print(f"\nbisect_left(45) = {pos}")

# Eleman var mÄ± kontrol et
if pos < len(dizi) and dizi[pos] == 45:
    print(f"45 dizide var! Ä°ndeks: {pos}")
else:
    print("45 dizide yok")

# bisect_right: ElemanÄ±n eklenmesi gereken saÄŸ pozisyon
# (AynÄ± elemanlarÄ±n saÄŸÄ±na ekler)
print(f"\nbisect_right(45) = {bisect.bisect_right(dizi, 45)}")

# insort: SÄ±ralÄ± ekleme
print(f"\nOrijinal: {dizi}")
bisect.insort(dizi, 50)
print(f"50 eklendi: {dizi}")</code></pre>
            <div id="output-code3" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ§© YaygÄ±n Binary Search VaryasyonlarÄ±</h2>

        <h3>Ä°lk ve Son EÅŸleÅŸmeyi Bulma</h3>
        <div class="code-container">
            <div class="code-header">
                <span>Python Kodu</span>
                <div>
                    <button class="btn btn-run" onclick="CodeBlocks.run(\'code4\')">â–¶ Ã‡alÄ±ÅŸtÄ±r</button>
                </div>
            </div>
            <pre id="view-code4"><code class="language-python line-numbers">def find_first(arr, target):
    """Target'Ä±n Ä°LK gÃ¶rÃ¼ndÃ¼ÄŸÃ¼ indeksi bulur"""
    low, high = 0, len(arr) - 1
    result = -1

    while low <= high:
        mid = (low + high) // 2
        if arr[mid] == target:
            result = mid       # Bulduk ama daha solda olabilir
            high = mid - 1     # Sola bakmaya devam
        elif arr[mid] < target:
            low = mid + 1
        else:
            high = mid - 1

    return result

def find_last(arr, target):
    """Target'Ä±n SON gÃ¶rÃ¼ndÃ¼ÄŸÃ¼ indeksi bulur"""
    low, high = 0, len(arr) - 1
    result = -1

    while low <= high:
        mid = (low + high) // 2
        if arr[mid] == target:
            result = mid       # Bulduk ama daha saÄŸda olabilir
            low = mid + 1      # SaÄŸa bakmaya devam
        elif arr[mid] < target:
            low = mid + 1
        else:
            high = mid - 1

    return result

# Test
dizi = [1, 2, 3, 3, 3, 3, 4, 5, 6]
print(f"Dizi: {dizi}")
print(f"Aranan: 3")

ilk = find_first(dizi, 3)
son = find_last(dizi, 3)

print(f"\nÄ°lk 3'Ã¼n indeksi: {ilk}")
print(f"Son 3'Ã¼n indeksi: {son}")
print(f"3'Ã¼n sayÄ±sÄ±: {son - ilk + 1}")</code></pre>
            <div id="output-code4" class="output">Ã‡Ä±ktÄ± bekleniyor...</div>
        </div>
    </div>

    <div class="section">
        <h2>ğŸŒ GerÃ§ek Hayat KullanÄ±m AlanlarÄ±</h2>
        <ul>
            <li>ğŸ“š <strong>SÃ¶zlÃ¼k uygulamalarÄ±:</strong> Kelime arama</li>
            <li>ğŸ—ƒï¸ <strong>VeritabanlarÄ±:</strong> B-Tree indeksleri</li>
            <li>ğŸ® <strong>Oyunlar:</strong> Skor tablolarÄ±, level seÃ§imi</li>
            <li>ğŸ” <strong>Git bisect:</strong> Bug'Ä±n hangi commit'te girdiÄŸini bulma</li>
            <li>ğŸ“Š <strong>Finansal uygulamalar:</strong> Fiyat aralÄ±ÄŸÄ± arama</li>
            <li>ğŸ—ºï¸ <strong>CoÄŸrafi aramalar:</strong> En yakÄ±n lokasyon bulma</li>
        </ul>
    </div>

    <div class="section">
        <h2>âš ï¸ Dikkat Edilmesi Gerekenler</h2>

        <div style="background: #f8d7da; padding: 20px; border-radius: 10px; border-left: 4px solid #e74c3c;">
            <h4 style="margin-top: 0; color: #721c24;">Integer Overflow Problemi</h4>
            <p><strong>HatalÄ±:</strong> <code>mid = (low + high) / 2</code></p>
            <p>Ã‡ok bÃ¼yÃ¼k sayÄ±larda low + high taÅŸabilir!</p>
            <p><strong>DoÄŸru:</strong> <code>mid = low + (high - low) // 2</code></p>
            <p style="margin: 0;">Python'da otomatik big integer olduÄŸu iÃ§in sorun olmaz, ama C/Java'da dikkat!</p>
        </div>
    </div>

    <div class="nav-footer">
        <a href="6a_linear_search.html" class="btn">â¬…ï¸ Ã–nceki: Linear Search</a>
        <a href="../index.html" class="btn" style="background:#e67e22">ğŸ  Ana MenÃ¼</a>
        <a href="7a_sorting_intro.html" class="btn btn-next">Sonraki: SÄ±ralama GiriÅŸ â¡ï¸</a>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
<script>
    // Binary Search SimÃ¼lasyonu - 15 elemanlÄ± sÄ±ralÄ± dizi
    const sortedArray = [5, 11, 15, 22, 28, 34, 41, 45, 52, 58, 64, 71, 78, 85, 90];
    let low = 0;
    let high = sortedArray.length - 1;
    let mid = -1;
    let searchTarget = null;
    let isSearching = false;
    let found = false;
    let eliminated = new Set();

    function renderArray() {
        const container = document.getElementById('arrayVisual');
        container.innerHTML = '';

        sortedArray.forEach((val, i) => {
            const cell = document.createElement('div');
            cell.className = 'array-cell';
            cell.id = `cell-${i}`;
            cell.innerHTML = `<span class="index">[${i}]</span>${val}`;

            if (eliminated.has(i)) {
                cell.classList.add('eliminated');
            } else if (i === mid && found) {
                cell.classList.add('found');
            } else if (i === mid) {
                cell.classList.add('mid');
            } else if (i >= low && i <= high) {
                cell.classList.add('active');
            }

            if (i === low && !eliminated.has(i)) cell.classList.add('low');
            if (i === high && !eliminated.has(i)) cell.classList.add('high');

            container.appendChild(cell);
        });

        // Pointer bilgilerini gÃ¼ncelle
        const pointerInfo = document.getElementById('pointerInfo');
        if (isSearching || found) {
            pointerInfo.innerHTML = `<span style="color:#27ae60">low=${low}</span> | <span style="color:#f39c12">mid=${mid}</span> | <span style="color:#e74c3c">high=${high}</span>`;
        } else {
            pointerInfo.innerHTML = '';
        }
    }

    function startBinarySearch() {
        const input = document.getElementById('searchValue');
        searchTarget = parseInt(input.value);

        if (isNaN(searchTarget)) {
            alert('LÃ¼tfen geÃ§erli bir sayÄ± girin!');
            return;
        }

        low = 0;
        high = sortedArray.length - 1;
        mid = -1;
        isSearching = true;
        found = false;
        eliminated = new Set();

        document.getElementById('stepLog').innerHTML = `ğŸ” ${searchTarget} aranÄ±yor...\n`;
        renderArray();
        runAutoSearch();
    }

    async function runAutoSearch() {
        while (low <= high && isSearching && !found) {
            await new Promise(r => setTimeout(r, 800));
            stepSearch();
        }
    }

    function stepSearch() {
        if (low > high) {
            document.getElementById('stepLog').innerHTML += `\nâŒ ${searchTarget} dizide bulunamadÄ±!`;
            isSearching = false;
            return;
        }

        mid = Math.floor((low + high) / 2);
        const log = document.getElementById('stepLog');
        const current = sortedArray[mid];

        log.innerHTML += `\nlow=${low}, high=${high}, mid=${mid} â†’ arr[${mid}]=${current}`;

        if (current === searchTarget) {
            log.innerHTML += ` âœ… BULUNDU!`;
            found = true;
            isSearching = false;
            renderArray();
            return;
        } else if (current < searchTarget) {
            log.innerHTML += ` â†’ ${current} < ${searchTarget}, saÄŸa git`;
            // Solu ele
            for (let i = low; i <= mid; i++) eliminated.add(i);
            low = mid + 1;
        } else {
            log.innerHTML += ` â†’ ${current} > ${searchTarget}, sola git`;
            // SaÄŸÄ± ele
            for (let i = mid; i <= high; i++) eliminated.add(i);
            high = mid - 1;
        }

        renderArray();
    }

    function resetSearch() {
        low = 0;
        high = sortedArray.length - 1;
        mid = -1;
        searchTarget = null;
        isSearching = false;
        found = false;
        eliminated = new Set();
        document.getElementById('searchValue').value = '';
        document.getElementById('stepLog').innerHTML = 'ğŸ¯ Bir sayÄ± girin ve "Ara" butonuna tÄ±klayÄ±n...';
        renderArray();
    }

    // BaÅŸlangÄ±Ã§ta render
    renderArray();

    // Pyodide
    let pyodideReady = false;
    let pyodide = null;

    async function main() {
        pyodide = await loadPyodide();
        pyodideReady = true;
    }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor..."); return; }
        const code = document.getElementById('view-' + id).textContent;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) { out.innerText = e; }
    }

    function toggleEdit(id) {
        const view = document.getElementById('view-' + id);
        const editor = document.getElementById(id);
        if (editor.style.display === 'block') {
            editor.style.display = 'none';
            view.style.display = 'block';
        } else {
            editor.style.display = 'block';
            view.style.display = 'none';
            editor.value = view.textContent;
            editor.focus();
        }
    }
</script>

    <!-- Prism.js scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

    <!-- Pyodide CDN -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.0/full/pyodide.js"></script>

    <!-- Unified JS -->
    <script src="../src/main.js"></script>
    <script src="../src/visualizations.js"></script>

    <!-- Page-specific JS -->
    <script>

    // Binary Search SimÃ¼lasyonu - 15 elemanlÄ± sÄ±ralÄ± dizi
    const sortedArray = [5, 11, 15, 22, 28, 34, 41, 45, 52, 58, 64, 71, 78, 85, 90];
    let low = 0;
    let high = sortedArray.length - 1;
    let mid = -1;
    let searchTarget = null;
    let isSearching = false;
    let found = false;
    let eliminated = new Set();

    function renderArray() {
        const container = document.getElementById('arrayVisual');
        container.innerHTML = '';

        sortedArray.forEach((val, i) => {
            const cell = document.createElement('div');
            cell.className = 'array-cell';
            cell.id = `cell-${i}`;
            cell.innerHTML = `<span class="index">[${i}]</span>${val}`;

            if (eliminated.has(i)) {
                cell.classList.add('eliminated');
            } else if (i === mid && found) {
                cell.classList.add('found');
            } else if (i === mid) {
                cell.classList.add('mid');
            } else if (i >= low && i <= high) {
                cell.classList.add('active');
            }

            if (i === low && !eliminated.has(i)) cell.classList.add('low');
            if (i === high && !eliminated.has(i)) cell.classList.add('high');

            container.appendChild(cell);
        });

        // Pointer bilgilerini gÃ¼ncelle
        const pointerInfo = document.getElementById('pointerInfo');
        if (isSearching || found) {
            pointerInfo.innerHTML = `<span style="color:#27ae60">low=${low}</span> | <span style="color:#f39c12">mid=${mid}</span> | <span style="color:#e74c3c">high=${high}</span>`;
        } else {
            pointerInfo.innerHTML = '';
        }
    }

    function startBinarySearch() {
        const input = document.getElementById('searchValue');
        searchTarget = parseInt(input.value);

        if (isNaN(searchTarget)) {
            alert('LÃ¼tfen geÃ§erli bir sayÄ± girin!');
            return;
        }

        low = 0;
        high = sortedArray.length - 1;
        mid = -1;
        isSearching = true;
        found = false;
        eliminated = new Set();

        document.getElementById('stepLog').innerHTML = `ğŸ” ${searchTarget} aranÄ±yor...\n`;
        renderArray();
        runAutoSearch();
    }

    async function runAutoSearch() {
        while (low <= high && isSearching && !found) {
            await new Promise(r => setTimeout(r, 800));
            stepSearch();
        }
    }

    function stepSearch() {
        if (low > high) {
            document.getElementById('stepLog').innerHTML += `\nâŒ ${searchTarget} dizide bulunamadÄ±!`;
            isSearching = false;
            return;
        }

        mid = Math.floor((low + high) / 2);
        const log = document.getElementById('stepLog');
        const current = sortedArray[mid];

        log.innerHTML += `\nlow=${low}, high=${high}, mid=${mid} â†’ arr[${mid}]=${current}`;

        if (current === searchTarget) {
            log.innerHTML += ` âœ… BULUNDU!`;
            found = true;
            isSearching = false;
            renderArray();
            return;
        } else if (current < searchTarget) {
            log.innerHTML += ` â†’ ${current} < ${searchTarget}, saÄŸa git`;
            // Solu ele
            for (let i = low; i <= mid; i++) eliminated.add(i);
            low = mid + 1;
        } else {
            log.innerHTML += ` â†’ ${current} > ${searchTarget}, sola git`;
            // SaÄŸÄ± ele
            for (let i = mid; i <= high; i++) eliminated.add(i);
            high = mid - 1;
        }

        renderArray();
    }

    function resetSearch() {
        low = 0;
        high = sortedArray.length - 1;
        mid = -1;
        searchTarget = null;
        isSearching = false;
        found = false;
        eliminated = new Set();
        document.getElementById('searchValue').value = '';
        document.getElementById('stepLog').innerHTML = 'ğŸ¯ Bir sayÄ± girin ve "Ara" butonuna tÄ±klayÄ±n...';
        renderArray();
    }

    // BaÅŸlangÄ±Ã§ta render
    renderArray();

    // Pyodide
    let pyodideReady = false;
    let pyodide = null;

    async function main() {
        pyodide = await loadPyodide();
        pyodideReady = true;
    }
    main();

    async function runPython(id) {
        if(!pyodideReady) { alert("Python yÃ¼kleniyor..."); return; }
        const code = document.getElementById('view-' + id).textContent;
        const out = document.getElementById('output-' + id);
        out.innerText = "Ã‡alÄ±ÅŸÄ±yor...";
        try {
            pyodide.runPython(`import sys; from io import StringIO; sys.stdout = StringIO()`);
            await pyodide.runPythonAsync(code);
            out.innerText = pyodide.runPython("sys.stdout.getvalue()");
        } catch(e) { out.innerText = e; }
    }

    function toggleEdit(id) {
        const view = document.getElementById('view-' + id);
        const editor = document.getElementById(id);
        if (editor.style.display === 'block') {
            editor.style.display = 'none';
            view.style.display = 'block';
        } else {
            editor.style.display = 'block';
            view.style.display = 'none';
            editor.value = view.textContent;
            editor.focus();
        }
    }

    </script>
</body>
</html>
